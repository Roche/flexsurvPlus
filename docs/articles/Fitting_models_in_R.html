<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitting parametric survival models in R • flexsurvPlus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fitting parametric survival models in R">
<meta property="og:description" content="flexsurvPlus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flexsurvPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.06</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://roche.github.io/Global-HTA-Evidence-Open/index.html">Global-HTA-Evidence-Open</a>
    </li>
    <li>
      <a href="https://roche.github.io/flexsurvPlus/index.html">flexsurvPlus</a>
    </li>
    <li>
      <a href="https://roche.github.io/gemtcPlus/index.html">gemtcPlus</a>
    </li>
    <li>
      <a href="https://roche.github.io/MAIC/index.html">MAIC</a>
    </li>
    <li>
      <a href="https://roche.github.io/rpsftmPlus/index.html">rpsftmPlus</a>
    </li>
    <li>
      <a href="https://roche.github.io/descem/index.html">descem</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Roche/flexsurvPlus">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Fitting_models_in_R_files/header-attrs-2.14/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fitting parametric survival models in R</h1>
                        <h4 class="author">Roche</h4>
            
            <h4 class="date">2022-06-08</h4>
      
      
      <div class="hidden name"><code>Fitting_models_in_R.Rmd</code></div>

    </div>

    
    
<style type="text/css">
  
  body{ /* Normal  */
      font-size: 14px;
  }
td {  /* Table  */
    font-size: 10px;
}
h1.title {
  font-size: 38px;
}
h1 { /* Header 1 */
    font-size: 28px;
}
h2 { /* Header 2 */
    font-size: 22px;
}
h3 { /* Header 3 */
    font-size: 18px;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Parametric survival models are often the preferred method of extrapolating survival data for use in economic models. The National Institute for Health and Care Excellence (NICE) Decision Support Unit (DSU) technical support document (TSD) 14 recommends that the Exponential, Weibull, Gompertz, log-logistic, log normal and Generalized Gamma parametric models should all be considered.<span class="citation">[1]</span> More recently, NICE also discusses more flexible models in NICE DSU TSD 21, however, more these models are not in the scope of this package.<span class="citation">[2]</span> The Canadian Agency for Drugs and Technologies in Health (CADTH) additionally specifies that the Gamma distribution must also be considered. This document therefore details the characteristics of each of these distributions and demonstrates how the parameters from each distribution, outputted using the flexsurvPlus package, can be implemented within an economic model.<span class="citation">[3]</span> The Generalized F distribution is not commonly used, however it has been included in this package in case it is required.</p>
<p>The flexsurvPlus package allows the inclusion of a treatment effect in the following four ways:</p>
<ul>
<li><p>Separate models - Models fitted to each treatment arm separately</p></li>
<li><p>Independent shape models - Models fitted to both/all treatment arms including a treatment covariate to model the effect of treatment on both the scale and shape parameter(s) of the distribution</p></li>
<li><p>Common shape models - Models fitted to both/all treatment arms including a treatment covariate to model the effect of treatment on the scale parameter of the distribution. The shape parameter(s) of the distribution is common across treatments which reflects an assumption of proportional hazards or accelerated failure time between treatments depending on the distribution</p></li>
<li><p>One arm models - Models fitted to the entire dataset (no treatment strata)</p></li>
</ul>
<p>This document details how to use the <tt>flexsurvPlus</tt> package to perform these models. A separate vignette; “Parametric survival analysis using the flexsurvPlus package: understanding the theory” details the theory behind the models.</p>
</div>
<div id="set-up-packages-and-data" class="section level1">
<h1 class="hasAnchor">
<a href="#set-up-packages-and-data" class="anchor"></a>Set up packages and data</h1>
<div id="install-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#install-packages" class="anchor"></a>Install packages</h2>
<p>The following packages are required to run this example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="co"># Libraries</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">flexsurvPlus</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="co"># Non-scientific notation</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">999</span><span class="op">)</span> 

<span class="co"># Colours for plots</span>
<span class="va">blue</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">69</span>, <span class="fl">185</span>, <span class="fl">209</span>, max<span class="op">=</span><span class="fl">255</span><span class="op">)</span>
<span class="va">pink</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">211</span>,<span class="fl">78</span>,<span class="fl">147</span>,max<span class="op">=</span><span class="fl">255</span><span class="op">)</span>
<span class="va">Dyellow</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">214</span>, <span class="fl">200</span>, <span class="fl">16</span>, max<span class="op">=</span><span class="fl">255</span><span class="op">)</span>
<span class="va">orange</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">247</span>,<span class="fl">139</span>,<span class="fl">21</span>,max<span class="op">=</span><span class="fl">255</span><span class="op">)</span></pre></div>
</div>
<div id="read-in-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#read-in-the-data" class="anchor"></a>Read in the data</h2>
<p>To perform survival analyses, patient level data is required for the survival endpoints.</p>
<p>This example uses a standard simulated data set (adtte). There is no standard naming that is needed for this package however, there are some set variables that are needed:</p>
<ul>
<li>Time - a numeric variable</li>
<li>Event - a binary variable (event=1, censor=0)</li>
<li>Treatment - a character variable with the name of the intervention treatment</li>
</ul>
<p>The data must be in “wide” format such that there is one row per patient and columns for each endpoint separately. In this example, we analyze progression-free survival (PFS).</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">adtte</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_adtte.html">sim_adtte</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">2020</span>, rho <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">adtte</span><span class="op">)</span>
<span class="co">#&gt;   USUBJID ARMCD             ARM PARAMCD                     PARAM AVAL AVALU</span>
<span class="co">#&gt; 1       1     A Reference Arm A     PFS Progression Free Survival  141  DAYS</span>
<span class="co">#&gt; 2       2     A Reference Arm A     PFS Progression Free Survival  173  DAYS</span>
<span class="co">#&gt; 3       3     A Reference Arm A     PFS Progression Free Survival  197  DAYS</span>
<span class="co">#&gt; 4       4     A Reference Arm A     PFS Progression Free Survival  133  DAYS</span>
<span class="co">#&gt; 5       5     A Reference Arm A     PFS Progression Free Survival  100  DAYS</span>
<span class="co">#&gt; 6       6     A Reference Arm A     PFS Progression Free Survival  525  DAYS</span>
<span class="co">#&gt;   CNSR</span>
<span class="co">#&gt; 1    0</span>
<span class="co">#&gt; 2    0</span>
<span class="co">#&gt; 3    0</span>
<span class="co">#&gt; 4    0</span>
<span class="co">#&gt; 5    0</span>
<span class="co">#&gt; 6    0</span>

<span class="co"># subset PFS data and rename</span>
<span class="va">PFS_data</span> <span class="op">&lt;-</span> <span class="va">adtte</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">PARAMCD</span><span class="op">==</span><span class="st">"PFS"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="va">USUBJID</span>,
            <span class="va">ARMCD</span>,
            PFS_days <span class="op">=</span> <span class="va">AVAL</span>,
            PFS_event <span class="op">=</span> <span class="fl">1</span><span class="op">-</span> <span class="va">CNSR</span>
  <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">PFS_data</span><span class="op">)</span>
<span class="co">#&gt;   USUBJID ARMCD PFS_days PFS_event</span>
<span class="co">#&gt; 1       1     A      141         1</span>
<span class="co">#&gt; 2       2     A      173         1</span>
<span class="co">#&gt; 3       3     A      197         1</span>
<span class="co">#&gt; 4       4     A      133         1</span>
<span class="co">#&gt; 5       5     A      100         1</span>
<span class="co">#&gt; 6       6     A      525         1</span></pre></div>
</div>
</div>
<div id="exploratory-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#exploratory-analysis" class="anchor"></a>Exploratory analysis</h1>
<p>Before performing any statistical analysis, it is important to explore the data. Most importantly is a Kaplan-Meier plot. A simple Kaplan-Meier plot has been produced here:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">

<span class="co"># Create survfit object</span>
<span class="va">km.est.PFS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">PFS_days</span>, <span class="va">PFS_event</span><span class="op">)</span> <span class="op">~</span> <span class="va">ARMCD</span>, 
                      data <span class="op">=</span> <span class="va">PFS_data</span>, 
                      conf.type <span class="op">=</span> <span class="st">'plain'</span><span class="op">)</span>

<span class="co"># Plot Kaplan-Meier</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">km.est.PFS</span>, 
     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">blue</span>, <span class="va">pink</span><span class="op">)</span>, <span class="co"># plot colours</span>
     lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="co"># line type</span>
     xlab <span class="op">=</span> <span class="st">"Time (Days)"</span>, <span class="co"># x-axis label</span>
     ylab <span class="op">=</span> <span class="st">"Progression-free survival"</span>, <span class="co"># y-axis label</span>
     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">800</span><span class="op">)</span><span class="op">)</span> 

<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">500</span>, 
       y <span class="op">=</span> <span class="fl">.9</span>, 
       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Arm A"</span>, <span class="st">"Arm B"</span><span class="op">)</span>, 
       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, 
       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">blue</span>, <span class="va">pink</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="Fitting_models_in_R_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div id="fitting-the-models" class="section level1">
<h1 class="hasAnchor">
<a href="#fitting-the-models" class="anchor"></a>Fitting the models</h1>
<p>The <tt>runPSM</tt> function fits parametric survival models for multiple distributions using the <tt>flexsurv</tt> package, manipulates the flexsurv objects to get the parameter estimates and AIC and BIC value (using the <tt>flexsurvPlus</tt> function <tt>get_params</tt>) and rearranges the parameter estimates such that they can easily be output to excel to calculate survival for both the intervention and reference treatment in an economic model.</p>
<p>These functions can be used to estimate 3 types of model:</p>
<ul>
<li>Separate models - Models fitted to each treatment arm separately
<ul>
<li>These models are fitted using the <tt>runPSM</tt> function using the <tt>model.type=“Separate”</tt> argument.</li>
</ul>
</li>
<li>Independent shape models - Models fitted to both/all treatment arms including a treatment covariate to model the effect of treatment on both the scale and shape parameter(s) of the distribution.
<ul>
<li>They have been fit using the <tt>runPSM</tt> function using the <tt>model.type=“Independent shape”</tt> argument.</li>
</ul>
</li>
<li>Common shape models - Models fitted to both/all treatment arms including a treatment covariate to model the effect of treatment on the scale parameter of the distribution. The shape parameter(s) of the distribution is common across treatments which reflects an assumption of proportional hazards or accelerated failure time between treatments depending on the distribution
<ul>
<li>These models have been fit using the <tt>runPSM</tt> function using the <tt>model.type=“Common shape”</tt> argument.</li>
</ul>
</li>
<li>One arm models - Models fitted to the entire dataset (no treatment strata)
<ul>
<li>These models are fitted using the <tt>runPSM</tt> function using the <tt>model.type=“One arm”</tt> argument.</li>
</ul>
</li>
</ul>
<p>The inputs to the <tt>runPSM</tt> function are:</p>
<ul>
<li><p><tt>data</tt> - A data frame containing individual patient data for the relevant time to event outcomes</p></li>
<li><p><tt>time_var</tt> - Name of time variable in ‘data.’ Variable must be numerical and &gt;0.</p></li>
<li><p><tt>event_var</tt> - Name of event variable in ‘data.’ Variable must be numerical and contain 1’s to indicate an event and 0 to indicate a censor.</p></li>
<li><p><tt>model.type</tt> - Character vector indicating the types of model formula provided. Permitted values are ‘Common shape,’ ‘Independent shape’ or ‘Separate’ as per the models explained above.</p></li>
<li>
<p><tt>distr</tt> - Each type of model can be fitted with multiple distributions. The distributions available for this package are:</p>
<ul>
<li><p>Exponential (‘exp’)</p></li>
<li><p>Weibull (‘weibull’)</p></li>
<li><p>Gompertz (‘gompertz’)</p></li>
<li><p>Log-normal (‘lnorm’)</p></li>
<li><p>Log-logistic (‘llogis’)</p></li>
<li><p>Generalized gamma (‘gengamma’)</p></li>
<li><p>Gamma (‘gamma’)</p></li>
<li><p>Generalized F (‘genf’)</p></li>
</ul>
</li>
<li><p><tt>strata_var</tt> - Name of stratification variable in “data.” This is usually the treatment variable and must be categorical. Not required when model.type=‘One arm.’</p></li>
<li><p><tt>int_name</tt> - Character to indicate the name of the treatment of interest, must be a level of the “strata_var” column in “data,” used for labelling the parameters.</p></li>
<li><p><tt>ref_name </tt> - Character to indicate the name of the reference treatment, must be a level of the “strata_var” column in “data,” used for labelling the parameters. Not required when model.type=‘One arm.’</p></li>
</ul>
<p>More information about each function can be used by running the code <tt>?runPSM</tt>.</p>
<p>Example code to fit all two arm models is presented below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">psm_PFS_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPSM.html">runPSM</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">PFS_data</span>,
                     time_var<span class="op">=</span><span class="st">"PFS_days"</span>,
                     event_var<span class="op">=</span><span class="st">"PFS_event"</span>,
                     model.type<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Common shape"</span>, 
                                   <span class="st">"Independent shape"</span>, 
                                   <span class="st">"Separate"</span><span class="op">)</span>,
                     distr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'exp'</span>,
                               <span class="st">'weibull'</span>,
                               <span class="st">'gompertz'</span>,
                               <span class="st">'lnorm'</span>,
                               <span class="st">'llogis'</span>,
                               <span class="st">'gengamma'</span>,
                               <span class="st">'gamma'</span>,
                               <span class="st">'genf'</span><span class="op">)</span>,
                     strata_var <span class="op">=</span> <span class="st">"ARMCD"</span>,
                     int_name<span class="op">=</span><span class="st">"A"</span>,
                     ref_name <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span>
<span class="va">psm_PFS_all</span>
<span class="co">#&gt; $models</span>
<span class="co">#&gt; $models$comshp.exp</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est       L95%      U95%      se        exp(est)  L95%    </span>
<span class="co">#&gt; rate          NA   0.002210  0.001911  0.002557  0.000164        NA        NA</span>
<span class="co">#&gt; ARMInt  0.500000   0.767591  0.574293  0.960889  0.098623  2.154570  1.775875</span>
<span class="co">#&gt;         U95%    </span>
<span class="co">#&gt; rate          NA</span>
<span class="co">#&gt; ARMInt  2.614019</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2798.33, df = 2</span>
<span class="co">#&gt; AIC = 5600.66</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$comshp.weibull</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est       L95%      U95%      se        exp(est)  L95%    </span>
<span class="co">#&gt; shape         NA     1.3881    1.2830    1.5017    0.0557        NA        NA</span>
<span class="co">#&gt; scale         NA   437.0600  393.4819  485.4643   23.4223        NA        NA</span>
<span class="co">#&gt; ARMInt    0.5000    -0.6623   -0.8035   -0.5211    0.0721    0.5157    0.4477</span>
<span class="co">#&gt;         U95%    </span>
<span class="co">#&gt; shape         NA</span>
<span class="co">#&gt; scale         NA</span>
<span class="co">#&gt; ARMInt    0.5939</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2769.611, df = 3</span>
<span class="co">#&gt; AIC = 5545.222</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$comshp.gompertz</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est       L95%      U95%      se        exp(est)  L95%    </span>
<span class="co">#&gt; shape         NA   0.002072  0.001455  0.002688  0.000315        NA        NA</span>
<span class="co">#&gt; rate          NA   0.001358  0.001091  0.001690  0.000152        NA        NA</span>
<span class="co">#&gt; ARMInt  0.500000   0.911755  0.712472  1.111039  0.101677  2.488687  2.039025</span>
<span class="co">#&gt;         U95%    </span>
<span class="co">#&gt; shape         NA</span>
<span class="co">#&gt; rate          NA</span>
<span class="co">#&gt; ARMInt  3.037512</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2779.001, df = 3</span>
<span class="co">#&gt; AIC = 5564.003</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$comshp.lnorm</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;          data mean  est      L95%     U95%     se       exp(est)  L95%   </span>
<span class="co">#&gt; meanlog       NA     5.7350   5.6068   5.8632   0.0654       NA        NA</span>
<span class="co">#&gt; sdlog         NA     0.9863   0.9199   1.0575   0.0351       NA        NA</span>
<span class="co">#&gt; ARMInt    0.5000    -0.7128  -0.8901  -0.5355   0.0905   0.4903    0.4106</span>
<span class="co">#&gt;          U95%   </span>
<span class="co">#&gt; meanlog       NA</span>
<span class="co">#&gt; sdlog         NA</span>
<span class="co">#&gt; ARMInt    0.5854</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2800.225, df = 3</span>
<span class="co">#&gt; AIC = 5606.451</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$comshp.llogis</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est       L95%      U95%      se        exp(est)  L95%    </span>
<span class="co">#&gt; shape         NA     1.9062    1.7573    2.0676    0.0791        NA        NA</span>
<span class="co">#&gt; scale         NA   323.1928  288.2447  362.3782   18.8707        NA        NA</span>
<span class="co">#&gt; ARMInt    0.5000    -0.6975   -0.8565   -0.5384    0.0812    0.4978    0.4246</span>
<span class="co">#&gt;         U95%    </span>
<span class="co">#&gt; shape         NA</span>
<span class="co">#&gt; scale         NA</span>
<span class="co">#&gt; ARMInt    0.5837</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2780.256, df = 3</span>
<span class="co">#&gt; AIC = 5566.512</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$comshp.gengamma</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est      L95%     U95%     se       exp(est)  L95%   </span>
<span class="co">#&gt; mu           NA     6.0574   5.9291   6.1857   0.0654       NA        NA</span>
<span class="co">#&gt; sigma        NA     0.7377   0.6624   0.8215   0.0405       NA        NA</span>
<span class="co">#&gt; Q            NA     0.9195   0.6682   1.1708   0.1282       NA        NA</span>
<span class="co">#&gt; ARMInt   0.5000    -0.6699  -0.8149  -0.5249   0.0740   0.5118    0.4427</span>
<span class="co">#&gt;         U95%   </span>
<span class="co">#&gt; mu           NA</span>
<span class="co">#&gt; sigma        NA</span>
<span class="co">#&gt; Q            NA</span>
<span class="co">#&gt; ARMInt   0.5916</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2769.421, df = 4</span>
<span class="co">#&gt; AIC = 5546.841</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$comshp.gamma</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est       L95%      U95%      se        exp(est)  L95%    </span>
<span class="co">#&gt; shape         NA   1.658113  1.465091  1.876566  0.104702        NA        NA</span>
<span class="co">#&gt; rate          NA   0.004046  0.003377  0.004846  0.000373        NA        NA</span>
<span class="co">#&gt; ARMInt  0.500000   0.684825  0.537124  0.832527  0.075359  1.983426  1.711078</span>
<span class="co">#&gt;         U95%    </span>
<span class="co">#&gt; shape         NA</span>
<span class="co">#&gt; rate          NA</span>
<span class="co">#&gt; ARMInt  2.299122</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2770.102, df = 3</span>
<span class="co">#&gt; AIC = 5546.203</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$comshp.genf</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est      L95%     U95%     se       exp(est)  L95%   </span>
<span class="co">#&gt; mu           NA     6.0061   5.8600   6.1523   0.0746       NA        NA</span>
<span class="co">#&gt; sigma        NA     0.6487   0.5128   0.8206   0.0778       NA        NA</span>
<span class="co">#&gt; Q            NA     0.7342   0.3803   1.0881   0.1806       NA        NA</span>
<span class="co">#&gt; P            NA     0.9507   0.1978   4.5692   0.7615       NA        NA</span>
<span class="co">#&gt; ARMInt   0.5000    -0.6866  -0.8313  -0.5420   0.0738   0.5033    0.4355</span>
<span class="co">#&gt;         U95%   </span>
<span class="co">#&gt; mu           NA</span>
<span class="co">#&gt; sigma        NA</span>
<span class="co">#&gt; Q            NA</span>
<span class="co">#&gt; P            NA</span>
<span class="co">#&gt; ARMInt   0.5816</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2768.32, df = 5</span>
<span class="co">#&gt; AIC = 5546.64</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.exp.int</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;       est       L95%      U95%      se      </span>
<span class="co">#&gt; rate  0.004762  0.004194  0.005408  0.000309</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1510.588, df = 1</span>
<span class="co">#&gt; AIC = 3023.176</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.weibull.int</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est       L95%      U95%      se      </span>
<span class="co">#&gt; shape    1.3841    1.2516    1.5306    0.0711</span>
<span class="co">#&gt; scale  225.2128  204.7892  247.6732   10.9235</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1493.471, df = 2</span>
<span class="co">#&gt; AIC = 2990.943</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.gompertz.int</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est       L95%      U95%      se      </span>
<span class="co">#&gt; shape  0.002126  0.001252  0.003000  0.000446</span>
<span class="co">#&gt; rate   0.003345  0.002719  0.004116  0.000354</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1500.61, df = 2</span>
<span class="co">#&gt; AIC = 3005.22</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.lnorm.int</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;          est     L95%    U95%    se    </span>
<span class="co">#&gt; meanlog  5.0201  4.9049  5.1352  0.0587</span>
<span class="co">#&gt; sdlog    0.9245  0.8442  1.0124  0.0428</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1508.722, df = 2</span>
<span class="co">#&gt; AIC = 3021.443</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.llogis.int</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est     L95%    U95%    se    </span>
<span class="co">#&gt; shape    2.02    1.81    2.24    0.11</span>
<span class="co">#&gt; scale  161.22  145.05  179.19    8.69</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1499.366, df = 2</span>
<span class="co">#&gt; AIC = 3002.733</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.gengamma.int</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est     L95%    U95%    se    </span>
<span class="co">#&gt; mu     5.3572  5.2058  5.5086  0.0772</span>
<span class="co">#&gt; sigma  0.7496  0.6635  0.8469  0.0467</span>
<span class="co">#&gt; Q      0.8349  0.5197  1.1501  0.1608</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1492.975, df = 3</span>
<span class="co">#&gt; AIC = 2991.95</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.gamma.int</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est       L95%      U95%      se      </span>
<span class="co">#&gt; shape  1.708525  1.447974  2.015960  0.144238</span>
<span class="co">#&gt; rate   0.008273  0.006806  0.010057  0.000824</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1493.076, df = 2</span>
<span class="co">#&gt; AIC = 2990.152</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.genf.int</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est     L95%    U95%    se    </span>
<span class="co">#&gt; mu     5.3121  5.1465  5.4777  0.0845</span>
<span class="co">#&gt; sigma  0.6579  0.4870  0.8888  0.1010</span>
<span class="co">#&gt; Q      0.7012  0.3001  1.1022  0.2046</span>
<span class="co">#&gt; P      0.8038  0.0983  6.5742  0.8619</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1492.383, df = 4</span>
<span class="co">#&gt; AIC = 2992.766</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.exp.ref</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;       est       L95%      U95%      se      </span>
<span class="co">#&gt; rate  0.002210  0.001911  0.002557  0.000164</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1287.742, df = 1</span>
<span class="co">#&gt; AIC = 2577.485</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.weibull.ref</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est       L95%      U95%      se      </span>
<span class="co">#&gt; shape    1.3944    1.2290    1.5821    0.0898</span>
<span class="co">#&gt; scale  436.9567  393.5292  485.1766   23.3372</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1276.135, df = 2</span>
<span class="co">#&gt; AIC = 2556.271</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.gompertz.ref</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est       L95%      U95%      se      </span>
<span class="co">#&gt; shape  0.002018  0.001149  0.002887  0.000443</span>
<span class="co">#&gt; rate   0.001377  0.001050  0.001807  0.000191</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1278.377, df = 2</span>
<span class="co">#&gt; AIC = 2560.755</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.lnorm.ref</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;          est     L95%    U95%    se    </span>
<span class="co">#&gt; meanlog  5.7541  5.6135  5.8946  0.0717</span>
<span class="co">#&gt; sdlog    1.0684  0.9587  1.1907  0.0591</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1289.469, df = 2</span>
<span class="co">#&gt; AIC = 2582.939</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.llogis.ref</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est      L95%     U95%     se     </span>
<span class="co">#&gt; shape    1.775    1.566    2.012    0.113</span>
<span class="co">#&gt; scale  324.711  287.502  366.736   20.163</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1279.735, df = 2</span>
<span class="co">#&gt; AIC = 2563.469</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.gengamma.ref</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est     L95%    U95%    se    </span>
<span class="co">#&gt; mu     6.1015  5.9352  6.2679  0.0849</span>
<span class="co">#&gt; sigma  0.6938  0.5462  0.8814  0.0847</span>
<span class="co">#&gt; Q      1.0810  0.5839  1.5782  0.2537</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1276.081, df = 3</span>
<span class="co">#&gt; AIC = 2558.162</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.gamma.ref</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est       L95%      U95%      se      </span>
<span class="co">#&gt; shape  1.596692  1.325325  1.923622  0.151750</span>
<span class="co">#&gt; rate   0.003872  0.003033  0.004943  0.000482</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1276.884, df = 2</span>
<span class="co">#&gt; AIC = 2557.768</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.genf.ref</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est     L95%    U95%    se    </span>
<span class="co">#&gt; mu      5.965   5.654   6.275   0.158</span>
<span class="co">#&gt; sigma   0.611   0.379   0.985   0.149</span>
<span class="co">#&gt; Q       0.601  -0.364   1.566   0.492</span>
<span class="co">#&gt; P       1.767   0.136  22.976   2.313</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1275.713, df = 4</span>
<span class="co">#&gt; AIC = 2559.427</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.exp</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est       L95%      U95%      se        exp(est)  L95%    </span>
<span class="co">#&gt; rate          NA   0.002210  0.001911  0.002557  0.000164        NA        NA</span>
<span class="co">#&gt; ARMInt  0.500000   0.767591  0.574293  0.960889  0.098623  2.154570  1.775875</span>
<span class="co">#&gt;         U95%    </span>
<span class="co">#&gt; rate          NA</span>
<span class="co">#&gt; ARMInt  2.614019</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2798.33, df = 2</span>
<span class="co">#&gt; AIC = 5600.66</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.weibull</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;                data mean  est        L95%       U95%       se         exp(est) </span>
<span class="co">#&gt; shape                 NA    1.39439    1.22897    1.58208    0.08984         NA</span>
<span class="co">#&gt; scale                 NA  436.95667  393.52916  485.17658   23.33723         NA</span>
<span class="co">#&gt; ARMInt           0.50000   -0.66279   -0.80419   -0.52138    0.07215    0.51541</span>
<span class="co">#&gt; shape(ARMInt)    0.50000   -0.00742   -0.16889    0.15406    0.08239    0.99261</span>
<span class="co">#&gt;                L95%       U95%     </span>
<span class="co">#&gt; shape                 NA         NA</span>
<span class="co">#&gt; scale                 NA         NA</span>
<span class="co">#&gt; ARMInt           0.44745    0.59370</span>
<span class="co">#&gt; shape(ARMInt)    0.84460    1.16656</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2769.607, df = 4</span>
<span class="co">#&gt; AIC = 5547.214</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.gompertz</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;                data mean  est        L95%       U95%       se         exp(est) </span>
<span class="co">#&gt; shape                 NA   0.002018   0.001194   0.002841   0.000420         NA</span>
<span class="co">#&gt; rate                  NA   0.001377   0.001050   0.001807   0.000191         NA</span>
<span class="co">#&gt; ARMInt          0.500000   0.887593   0.545992   1.229194   0.174289   2.429276</span>
<span class="co">#&gt; shape(ARMInt)   0.500000   0.000108  -0.001115   0.001332   0.000624   1.000108</span>
<span class="co">#&gt;                L95%       U95%     </span>
<span class="co">#&gt; shape                 NA         NA</span>
<span class="co">#&gt; rate                  NA         NA</span>
<span class="co">#&gt; ARMInt          1.726320   3.418474</span>
<span class="co">#&gt; shape(ARMInt)   0.998886   1.001332</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2778.987, df = 4</span>
<span class="co">#&gt; AIC = 5565.974</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.llogis</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;                data mean  est       L95%      U95%      se        exp(est)</span>
<span class="co">#&gt; shape                NA     1.7752    1.5662    2.0121    0.1134        NA</span>
<span class="co">#&gt; scale                NA   324.7128  287.5038  366.7375   20.1633        NA</span>
<span class="co">#&gt; ARMInt           0.5000    -0.7002   -0.8614   -0.5390    0.0822    0.4965</span>
<span class="co">#&gt; shape(ARMInt)    0.5000     0.1272   -0.0375    0.2919    0.0840    1.1357</span>
<span class="co">#&gt;                L95%      U95%    </span>
<span class="co">#&gt; shape                NA        NA</span>
<span class="co">#&gt; scale                NA        NA</span>
<span class="co">#&gt; ARMInt           0.4226    0.5833</span>
<span class="co">#&gt; shape(ARMInt)    0.9632    1.3390</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2779.101, df = 4</span>
<span class="co">#&gt; AIC = 5566.202</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.gamma</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;                data mean  est        L95%       U95%       se         exp(est) </span>
<span class="co">#&gt; shape                 NA   1.596555   1.325203   1.923470   0.151743         NA</span>
<span class="co">#&gt; rate                  NA   0.003871   0.003032   0.004942   0.000482         NA</span>
<span class="co">#&gt; ARMInt          0.500000   0.759334   0.446665   1.072003   0.159528   2.136853</span>
<span class="co">#&gt; shape(ARMInt)   0.500000   0.067700  -0.181462   0.316863   0.127126   1.070045</span>
<span class="co">#&gt;                L95%       U95%     </span>
<span class="co">#&gt; shape                 NA         NA</span>
<span class="co">#&gt; rate                  NA         NA</span>
<span class="co">#&gt; ARMInt          1.563091   2.921226</span>
<span class="co">#&gt; shape(ARMInt)   0.834050   1.372814</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2769.96, df = 4</span>
<span class="co">#&gt; AIC = 5547.919</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.lnorm</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;                data mean  est       L95%      U95%      se        exp(est)</span>
<span class="co">#&gt; meanlog              NA    5.75408   5.61352   5.89464   0.07172        NA</span>
<span class="co">#&gt; sdlog                NA    1.06842   0.95866   1.19074   0.05909        NA</span>
<span class="co">#&gt; ARMInt          0.50000   -0.73401  -0.91570  -0.55232   0.09270   0.47998</span>
<span class="co">#&gt; sdlog(ARMInt)   0.50000   -0.14466  -0.28608  -0.00323   0.07216   0.86532</span>
<span class="co">#&gt;                L95%      U95%    </span>
<span class="co">#&gt; meanlog              NA        NA</span>
<span class="co">#&gt; sdlog                NA        NA</span>
<span class="co">#&gt; ARMInt          0.40024   0.57561</span>
<span class="co">#&gt; sdlog(ARMInt)   0.75120   0.99678</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2798.191, df = 4</span>
<span class="co">#&gt; AIC = 5604.382</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.gengamma</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;                data mean  est      L95%     U95%     se       exp(est)  L95%   </span>
<span class="co">#&gt; mu                  NA     6.1016   5.9352   6.2680   0.0849       NA        NA</span>
<span class="co">#&gt; sigma               NA     0.6938   0.5461   0.8814   0.0847       NA        NA</span>
<span class="co">#&gt; Q                   NA     1.0814   0.5840   1.5788   0.2538       NA        NA</span>
<span class="co">#&gt; ARMInt          0.5000    -0.7444  -0.9693  -0.5194   0.1148   0.4750    0.3794</span>
<span class="co">#&gt; sigma(ARMInt)   0.5000     0.0773  -0.1913   0.3460   0.1371   1.0804    0.8258</span>
<span class="co">#&gt; Q(ARMInt)       0.5000    -0.2465  -0.8353   0.3423   0.3004   0.7816    0.4338</span>
<span class="co">#&gt;                U95%   </span>
<span class="co">#&gt; mu                  NA</span>
<span class="co">#&gt; sigma               NA</span>
<span class="co">#&gt; Q                   NA</span>
<span class="co">#&gt; ARMInt          0.5949</span>
<span class="co">#&gt; sigma(ARMInt)   1.4134</span>
<span class="co">#&gt; Q(ARMInt)       1.4082</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2769.056, df = 6</span>
<span class="co">#&gt; AIC = 5550.112</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.genf</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;                data mean  est      L95%     U95%     se       exp(est)  L95%   </span>
<span class="co">#&gt; mu                  NA     5.9638   5.6539   6.2738   0.1582       NA        NA</span>
<span class="co">#&gt; sigma               NA     0.6104   0.3781   0.9853   0.1491       NA        NA</span>
<span class="co">#&gt; Q                   NA     0.5991  -0.3641   1.5623   0.4914       NA        NA</span>
<span class="co">#&gt; P                   NA     1.7770   0.1382  22.8488   2.3156       NA        NA</span>
<span class="co">#&gt; ARMInt          0.5000    -0.6517  -1.0031  -0.3002   0.1793   0.5212    0.3667</span>
<span class="co">#&gt; sigma(ARMInt)   0.5000     0.0753  -0.4902   0.6409   0.2886   1.0782    0.6125</span>
<span class="co">#&gt; Q(ARMInt)       0.5000     0.1022  -0.9411   1.1456   0.5323   1.1076    0.3902</span>
<span class="co">#&gt; P(ARMInt)       0.5000    -0.7957  -4.1067   2.5153   1.6893   0.4513    0.0165</span>
<span class="co">#&gt;                U95%   </span>
<span class="co">#&gt; mu                  NA</span>
<span class="co">#&gt; sigma               NA</span>
<span class="co">#&gt; Q                   NA</span>
<span class="co">#&gt; P                   NA</span>
<span class="co">#&gt; ARMInt          0.7407</span>
<span class="co">#&gt; sigma(ARMInt)   1.8982</span>
<span class="co">#&gt; Q(ARMInt)       3.1443</span>
<span class="co">#&gt; P(ARMInt)      12.3708</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2768.096, df = 8</span>
<span class="co">#&gt; AIC = 5552.193</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model_summary</span>
<span class="co">#&gt;         flexsurvfit                   Model                  ModelF</span>
<span class="co">#&gt; 1        comshp.exp            Common shape            Common shape</span>
<span class="co">#&gt; 2    comshp.weibull            Common shape            Common shape</span>
<span class="co">#&gt; 3   comshp.gompertz            Common shape            Common shape</span>
<span class="co">#&gt; 4      comshp.lnorm            Common shape            Common shape</span>
<span class="co">#&gt; 5     comshp.llogis            Common shape            Common shape</span>
<span class="co">#&gt; 6   comshp.gengamma            Common shape            Common shape</span>
<span class="co">#&gt; 7      comshp.gamma            Common shape            Common shape</span>
<span class="co">#&gt; 8       comshp.genf            Common shape            Common shape</span>
<span class="co">#&gt; 9       sep.exp.int Separate - Intervention Separate - Intervention</span>
<span class="co">#&gt; 10  sep.weibull.int Separate - Intervention Separate - Intervention</span>
<span class="co">#&gt; 11 sep.gompertz.int Separate - Intervention Separate - Intervention</span>
<span class="co">#&gt; 12    sep.lnorm.int Separate - Intervention Separate - Intervention</span>
<span class="co">#&gt; 13   sep.llogis.int Separate - Intervention Separate - Intervention</span>
<span class="co">#&gt; 14 sep.gengamma.int Separate - Intervention Separate - Intervention</span>
<span class="co">#&gt; 15    sep.gamma.int Separate - Intervention Separate - Intervention</span>
<span class="co">#&gt; 16     sep.genf.int Separate - Intervention Separate - Intervention</span>
<span class="co">#&gt; 17      sep.exp.ref    Separate - Reference    Separate - Reference</span>
<span class="co">#&gt; 18  sep.weibull.ref    Separate - Reference    Separate - Reference</span>
<span class="co">#&gt; 19 sep.gompertz.ref    Separate - Reference    Separate - Reference</span>
<span class="co">#&gt; 20    sep.lnorm.ref    Separate - Reference    Separate - Reference</span>
<span class="co">#&gt; 21   sep.llogis.ref    Separate - Reference    Separate - Reference</span>
<span class="co">#&gt; 22 sep.gengamma.ref    Separate - Reference    Separate - Reference</span>
<span class="co">#&gt; 23    sep.gamma.ref    Separate - Reference    Separate - Reference</span>
<span class="co">#&gt; 24     sep.genf.ref    Separate - Reference    Separate - Reference</span>
<span class="co">#&gt; 25       indshp.exp       Independent shape       Independent shape</span>
<span class="co">#&gt; 26   indshp.weibull       Independent shape       Independent shape</span>
<span class="co">#&gt; 27  indshp.gompertz       Independent shape       Independent shape</span>
<span class="co">#&gt; 28    indshp.llogis       Independent shape       Independent shape</span>
<span class="co">#&gt; 29     indshp.gamma       Independent shape       Independent shape</span>
<span class="co">#&gt; 30     indshp.lnorm       Independent shape       Independent shape</span>
<span class="co">#&gt; 31  indshp.gengamma       Independent shape       Independent shape</span>
<span class="co">#&gt; 32      indshp.genf       Independent shape       Independent shape</span>
<span class="co">#&gt;                 Dist             DistF    distr Intervention_name</span>
<span class="co">#&gt; 1        Exponential       Exponential      exp                 A</span>
<span class="co">#&gt; 2            Weibull           Weibull  weibull                 A</span>
<span class="co">#&gt; 3           Gompertz          Gompertz gompertz                 A</span>
<span class="co">#&gt; 4         Log Normal        Log Normal    lnorm                 A</span>
<span class="co">#&gt; 5       Log Logistic      Log Logistic   llogis                 A</span>
<span class="co">#&gt; 6  Generalized Gamma Generalized Gamma gengamma                 A</span>
<span class="co">#&gt; 7              Gamma             Gamma    gamma                 A</span>
<span class="co">#&gt; 8      Generalized F     Generalized F     genf                 A</span>
<span class="co">#&gt; 9        Exponential       Exponential      exp                 A</span>
<span class="co">#&gt; 10           Weibull           Weibull  weibull                 A</span>
<span class="co">#&gt; 11          Gompertz          Gompertz gompertz                 A</span>
<span class="co">#&gt; 12        Log Normal        Log Normal    lnorm                 A</span>
<span class="co">#&gt; 13      Log Logistic      Log Logistic   llogis                 A</span>
<span class="co">#&gt; 14 Generalized Gamma Generalized Gamma gengamma                 A</span>
<span class="co">#&gt; 15             Gamma             Gamma    gamma                 A</span>
<span class="co">#&gt; 16     Generalized F     Generalized F     genf                 A</span>
<span class="co">#&gt; 17       Exponential       Exponential      exp                 A</span>
<span class="co">#&gt; 18           Weibull           Weibull  weibull                 A</span>
<span class="co">#&gt; 19          Gompertz          Gompertz gompertz                 A</span>
<span class="co">#&gt; 20        Log Normal        Log Normal    lnorm                 A</span>
<span class="co">#&gt; 21      Log Logistic      Log Logistic   llogis                 A</span>
<span class="co">#&gt; 22 Generalized Gamma Generalized Gamma gengamma                 A</span>
<span class="co">#&gt; 23             Gamma             Gamma    gamma                 A</span>
<span class="co">#&gt; 24     Generalized F     Generalized F     genf                 A</span>
<span class="co">#&gt; 25       Exponential       Exponential      exp                 A</span>
<span class="co">#&gt; 26           Weibull           Weibull  weibull                 A</span>
<span class="co">#&gt; 27          Gompertz          Gompertz gompertz                 A</span>
<span class="co">#&gt; 28      Log Logistic      Log Logistic   llogis                 A</span>
<span class="co">#&gt; 29             Gamma             Gamma    gamma                 A</span>
<span class="co">#&gt; 30        Log Normal        Log Normal    lnorm                 A</span>
<span class="co">#&gt; 31 Generalized Gamma Generalized Gamma gengamma                 A</span>
<span class="co">#&gt; 32     Generalized F     Generalized F     genf                 A</span>
<span class="co">#&gt;    Reference_name    Status      AIC      BIC</span>
<span class="co">#&gt; 1               B Converged 5600.660 5609.089</span>
<span class="co">#&gt; 2               B Converged 5545.222 5557.866</span>
<span class="co">#&gt; 3               B Converged 5564.003 5576.647</span>
<span class="co">#&gt; 4               B Converged 5606.451 5619.094</span>
<span class="co">#&gt; 5               B Converged 5566.512 5579.156</span>
<span class="co">#&gt; 6               B Converged 5546.841 5563.699</span>
<span class="co">#&gt; 7               B Converged 5546.203 5558.847</span>
<span class="co">#&gt; 8               B Converged 5546.640 5567.713</span>
<span class="co">#&gt; 9               B Converged 3023.176 3026.697</span>
<span class="co">#&gt; 10              B Converged 2990.943 2997.986</span>
<span class="co">#&gt; 11              B Converged 3005.220 3012.263</span>
<span class="co">#&gt; 12              B Converged 3021.443 3028.486</span>
<span class="co">#&gt; 13              B Converged 3002.733 3009.776</span>
<span class="co">#&gt; 14              B Converged 2991.950 3002.514</span>
<span class="co">#&gt; 15              B Converged 2990.152 2997.195</span>
<span class="co">#&gt; 16              B Converged 2992.766 3006.852</span>
<span class="co">#&gt; 17              B Converged 2577.485 2581.006</span>
<span class="co">#&gt; 18              B Converged 2556.271 2563.314</span>
<span class="co">#&gt; 19              B Converged 2560.755 2567.798</span>
<span class="co">#&gt; 20              B Converged 2582.939 2589.982</span>
<span class="co">#&gt; 21              B Converged 2563.469 2570.512</span>
<span class="co">#&gt; 22              B Converged 2558.162 2568.727</span>
<span class="co">#&gt; 23              B Converged 2557.768 2564.810</span>
<span class="co">#&gt; 24              B Converged 2559.427 2573.512</span>
<span class="co">#&gt; 25              B Converged 5600.660 5609.089</span>
<span class="co">#&gt; 26              B Converged 5547.214 5564.072</span>
<span class="co">#&gt; 27              B Converged 5565.974 5582.833</span>
<span class="co">#&gt; 28              B Converged 5566.202 5583.060</span>
<span class="co">#&gt; 29              B Converged 5547.919 5564.778</span>
<span class="co">#&gt; 30              B Converged 5604.382 5621.241</span>
<span class="co">#&gt; 31              B Converged 5550.112 5575.400</span>
<span class="co">#&gt; 32              B Converged 5552.193 5585.910</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameters_vector</span>
<span class="co">#&gt;       comshp.exp.rate.int       comshp.exp.rate.ref        comshp.exp.rate.TE </span>
<span class="co">#&gt;              0.0047623812              0.0022103631              0.7675910101 </span>
<span class="co">#&gt;  comshp.weibull.scale.int  comshp.weibull.scale.ref  comshp.weibull.shape.int </span>
<span class="co">#&gt;            225.3719486376            437.0599651237              1.3880696669 </span>
<span class="co">#&gt;  comshp.weibull.shape.ref   comshp.weibull.scale.TE  comshp.gompertz.rate.int </span>
<span class="co">#&gt;              1.3880696669             -0.6623182633              0.0033789924 </span>
<span class="co">#&gt;  comshp.gompertz.rate.ref comshp.gompertz.shape.int comshp.gompertz.shape.ref </span>
<span class="co">#&gt;              0.0013577411              0.0020717908              0.0020717908 </span>
<span class="co">#&gt;   comshp.gompertz.rate.TE   comshp.llogis.scale.int   comshp.llogis.scale.ref </span>
<span class="co">#&gt;              0.9117551704            160.9000992103            323.1928425421 </span>
<span class="co">#&gt;   comshp.llogis.shape.int   comshp.llogis.shape.ref    comshp.llogis.scale.TE </span>
<span class="co">#&gt;              1.9061724797              1.9061724797             -0.6974655102 </span>
<span class="co">#&gt;     comshp.gamma.rate.int     comshp.gamma.rate.ref    comshp.gamma.shape.int </span>
<span class="co">#&gt;              0.0080245065              0.0040457815              1.6581134582 </span>
<span class="co">#&gt;    comshp.gamma.shape.ref      comshp.gamma.rate.TE  comshp.lnorm.meanlog.int </span>
<span class="co">#&gt;              1.6581134582              0.6848254471              5.0221729357 </span>
<span class="co">#&gt;  comshp.lnorm.meanlog.ref    comshp.lnorm.sdlog.int    comshp.lnorm.sdlog.ref </span>
<span class="co">#&gt;              5.7349959337              0.9862777518              0.9862777518 </span>
<span class="co">#&gt;   comshp.lnorm.meanlog.TE    comshp.gengamma.mu.int    comshp.gengamma.mu.ref </span>
<span class="co">#&gt;             -0.7128229980              5.3875051273              6.0574058623 </span>
<span class="co">#&gt; comshp.gengamma.sigma.int comshp.gengamma.sigma.ref     comshp.gengamma.Q.int </span>
<span class="co">#&gt;              0.7376518510              0.7376518510              0.9194986169 </span>
<span class="co">#&gt;     comshp.gengamma.Q.ref     comshp.gengamma.mu.TE        comshp.genf.mu.int </span>
<span class="co">#&gt;              0.9194986169             -0.6699007349              5.3195083034 </span>
<span class="co">#&gt;        comshp.genf.mu.ref     comshp.genf.sigma.int     comshp.genf.sigma.ref </span>
<span class="co">#&gt;              6.0061403615              0.6486737906              0.6486737906 </span>
<span class="co">#&gt;         comshp.genf.Q.int         comshp.genf.Q.ref         comshp.genf.P.int </span>
<span class="co">#&gt;              0.7342316252              0.7342316252              0.9507499700 </span>
<span class="co">#&gt;         comshp.genf.P.ref         comshp.genf.mu.TE          sep.exp.rate.int </span>
<span class="co">#&gt;              0.9507499700             -0.6866320581              0.0047623812 </span>
<span class="co">#&gt;          sep.exp.rate.ref     sep.weibull.scale.int     sep.weibull.scale.ref </span>
<span class="co">#&gt;              0.0022103631            225.2127835800            436.9566692923 </span>
<span class="co">#&gt;     sep.weibull.shape.int     sep.weibull.shape.ref     sep.gompertz.rate.int </span>
<span class="co">#&gt;              1.3840902659              1.3943919665              0.0033452613 </span>
<span class="co">#&gt;     sep.gompertz.rate.ref    sep.gompertz.shape.int    sep.gompertz.shape.ref </span>
<span class="co">#&gt;              0.0013770185              0.0021260249              0.0020177231 </span>
<span class="co">#&gt;      sep.llogis.scale.int      sep.llogis.scale.ref      sep.llogis.shape.int </span>
<span class="co">#&gt;            161.2189290723            324.7112201561              2.0160853126 </span>
<span class="co">#&gt;      sep.llogis.shape.ref        sep.gamma.rate.int        sep.gamma.rate.ref </span>
<span class="co">#&gt;              1.7751939048              0.0082731268              0.0038716353 </span>
<span class="co">#&gt;       sep.gamma.shape.int       sep.gamma.shape.ref     sep.lnorm.meanlog.int </span>
<span class="co">#&gt;              1.7085247925              1.5966917414              5.0200744483 </span>
<span class="co">#&gt;     sep.lnorm.meanlog.ref       sep.lnorm.sdlog.int       sep.lnorm.sdlog.ref </span>
<span class="co">#&gt;              5.7540864808              0.9245220837              1.0684159722 </span>
<span class="co">#&gt;       sep.gengamma.mu.int       sep.gengamma.mu.ref    sep.gengamma.sigma.int </span>
<span class="co">#&gt;              5.3572157739              6.1015374964              0.7495725809 </span>
<span class="co">#&gt;    sep.gengamma.sigma.ref        sep.gengamma.Q.int        sep.gengamma.Q.ref </span>
<span class="co">#&gt;              0.6938119258              0.8349064781              1.0810413968 </span>
<span class="co">#&gt;           sep.genf.mu.int           sep.genf.mu.ref        sep.genf.sigma.int </span>
<span class="co">#&gt;              5.3121167643              5.9645192695              0.6579307455 </span>
<span class="co">#&gt;        sep.genf.sigma.ref            sep.genf.Q.int            sep.genf.Q.ref </span>
<span class="co">#&gt;              0.6108374874              0.7011635404              0.6013766571 </span>
<span class="co">#&gt;            sep.genf.P.int            sep.genf.P.ref       indshp.exp.rate.int </span>
<span class="co">#&gt;              0.8037990819              1.7674326582              0.0047623812 </span>
<span class="co">#&gt;       indshp.exp.rate.ref        indshp.exp.rate.TE  indshp.weibull.scale.int </span>
<span class="co">#&gt;              0.0022103631              0.7675910101            225.2127807052 </span>
<span class="co">#&gt;  indshp.weibull.scale.ref  indshp.weibull.shape.int  indshp.weibull.shape.ref </span>
<span class="co">#&gt;            436.9566724857              1.3840902608              1.3943919552 </span>
<span class="co">#&gt;   indshp.weibull.scale.TE   indshp.weibull.shape.TE  indshp.gompertz.rate.int </span>
<span class="co">#&gt;             -0.6627883952             -0.0074153734              0.0033453627 </span>
<span class="co">#&gt;  indshp.gompertz.rate.ref indshp.gompertz.shape.int indshp.gompertz.shape.ref </span>
<span class="co">#&gt;              0.0013771028              0.0021259492              0.0020175414 </span>
<span class="co">#&gt;   indshp.gompertz.rate.TE  indshp.gompertz.shape.TE   indshp.llogis.scale.int </span>
<span class="co">#&gt;              0.8875932775              0.0001084078            161.2182070372 </span>
<span class="co">#&gt;   indshp.llogis.scale.ref   indshp.llogis.shape.int   indshp.llogis.shape.ref </span>
<span class="co">#&gt;            324.7128381498              2.0160768391              1.7752113169 </span>
<span class="co">#&gt;    indshp.llogis.scale.TE    indshp.llogis.shape.TE     indshp.gamma.rate.int </span>
<span class="co">#&gt;             -0.7001824462              0.1272339965              0.0082721418 </span>
<span class="co">#&gt;     indshp.gamma.rate.ref    indshp.gamma.shape.int    indshp.gamma.shape.ref </span>
<span class="co">#&gt;              0.0038711789              1.7083852182              1.5965550369 </span>
<span class="co">#&gt;      indshp.gamma.rate.TE     indshp.gamma.shape.TE  indshp.lnorm.meanlog.int </span>
<span class="co">#&gt;              0.7593343613              0.0677004015              5.0200744478 </span>
<span class="co">#&gt;  indshp.lnorm.meanlog.ref    indshp.lnorm.sdlog.int    indshp.lnorm.sdlog.ref </span>
<span class="co">#&gt;              5.7540824669              0.9245219161              1.0684159578 </span>
<span class="co">#&gt;   indshp.lnorm.meanlog.TE     indshp.lnorm.sdlog.TE    indshp.gengamma.mu.int </span>
<span class="co">#&gt;             -0.7340080191             -0.1446556608              5.3572365418 </span>
<span class="co">#&gt;    indshp.gengamma.mu.ref indshp.gengamma.sigma.int indshp.gengamma.sigma.ref </span>
<span class="co">#&gt;              6.1015975586              0.7495580016              0.6937828807 </span>
<span class="co">#&gt;     indshp.gengamma.Q.int     indshp.gengamma.Q.ref     indshp.gengamma.mu.TE </span>
<span class="co">#&gt;              0.8349304188              1.0813995751             -0.7443610168 </span>
<span class="co">#&gt;  indshp.gengamma.sigma.TE        indshp.genf.mu.int        indshp.genf.mu.ref </span>
<span class="co">#&gt;              0.0773246421              5.3121786256              5.9638342995 </span>
<span class="co">#&gt;     indshp.genf.sigma.int     indshp.genf.sigma.ref         indshp.genf.Q.int </span>
<span class="co">#&gt;              0.6581219654              0.6103736384              0.7013283752 </span>
<span class="co">#&gt;         indshp.genf.Q.ref         indshp.genf.P.int         indshp.genf.P.ref </span>
<span class="co">#&gt;              0.5991052605              0.8019159789              1.7770415367 </span>
<span class="co">#&gt;         indshp.genf.mu.TE      indshp.genf.sigma.TE          indshp.genf.Q.TE </span>
<span class="co">#&gt;             -0.6516556739              0.0753189804              0.1022231148 </span>
<span class="co">#&gt;          indshp.genf.P.TE </span>
<span class="co">#&gt;             -0.7957013646 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $config</span>
<span class="co">#&gt; $config$data</span>
<span class="co">#&gt;     USUBJID ARMCD PFS_days PFS_event</span>
<span class="co">#&gt; 1         1     A      141         1</span>
<span class="co">#&gt; 2         2     A      173         1</span>
<span class="co">#&gt; 3         3     A      197         1</span>
<span class="co">#&gt; 4         4     A      133         1</span>
<span class="co">#&gt; 5         5     A      100         1</span>
<span class="co">#&gt; 6         6     A      525         1</span>
<span class="co">#&gt; 7         7     A      464         1</span>
<span class="co">#&gt; 8         8     A      305         1</span>
<span class="co">#&gt; 9         9     A      673         0</span>
<span class="co">#&gt; 10       10     A       39         1</span>
<span class="co">#&gt; 11       11     A      160         1</span>
<span class="co">#&gt; 12       12     A      270         1</span>
<span class="co">#&gt; 13       13     A       39         1</span>
<span class="co">#&gt; 14       14     A      256         1</span>
<span class="co">#&gt; 15       15     A      193         1</span>
<span class="co">#&gt; 16       16     A      203         1</span>
<span class="co">#&gt; 17       17     A       30         1</span>
<span class="co">#&gt; 18       18     A      114         1</span>
<span class="co">#&gt; 19       19     A      111         1</span>
<span class="co">#&gt; 20       20     A      244         1</span>
<span class="co">#&gt; 21       21     A      403         1</span>
<span class="co">#&gt; 22       22     A      613         1</span>
<span class="co">#&gt; 23       23     A      219         1</span>
<span class="co">#&gt; 24       24     A       72         1</span>
<span class="co">#&gt; 25       25     A       85         1</span>
<span class="co">#&gt; 26       26     A      257         1</span>
<span class="co">#&gt; 27       27     A      175         1</span>
<span class="co">#&gt; 28       28     A       99         1</span>
<span class="co">#&gt; 29       29     A      208         1</span>
<span class="co">#&gt; 30       30     A      108         1</span>
<span class="co">#&gt; 31       31     A      105         1</span>
<span class="co">#&gt; 32       32     A      319         1</span>
<span class="co">#&gt; 33       33     A      123         1</span>
<span class="co">#&gt; 34       34     A       76         1</span>
<span class="co">#&gt; 35       35     A      495         0</span>
<span class="co">#&gt; 36       36     A      161         1</span>
<span class="co">#&gt; 37       37     A      241         1</span>
<span class="co">#&gt; 38       38     A       22         1</span>
<span class="co">#&gt; 39       39     A      199         1</span>
<span class="co">#&gt; 40       40     A      304         1</span>
<span class="co">#&gt; 41       41     A      142         1</span>
<span class="co">#&gt; 42       42     A      372         1</span>
<span class="co">#&gt; 43       43     A      161         1</span>
<span class="co">#&gt; 44       44     A       84         1</span>
<span class="co">#&gt; 45       45     A      197         1</span>
<span class="co">#&gt; 46       46     A      132         1</span>
<span class="co">#&gt; 47       47     A      281         1</span>
<span class="co">#&gt; 48       48     A       14         1</span>
<span class="co">#&gt; 49       49     A      302         1</span>
<span class="co">#&gt; 50       50     A      208         1</span>
<span class="co">#&gt; 51       51     A       26         1</span>
<span class="co">#&gt; 52       52     A      234         1</span>
<span class="co">#&gt; 53       53     A       35         1</span>
<span class="co">#&gt; 54       54     A      232         1</span>
<span class="co">#&gt; 55       55     A       81         1</span>
<span class="co">#&gt; 56       56     A       58         1</span>
<span class="co">#&gt; 57       57     A      277         1</span>
<span class="co">#&gt; 58       58     A      347         1</span>
<span class="co">#&gt; 59       59     A      295         1</span>
<span class="co">#&gt; 60       60     A      157         1</span>
<span class="co">#&gt; 61       61     A      266         1</span>
<span class="co">#&gt; 62       62     A      116         1</span>
<span class="co">#&gt; 63       63     A      620         1</span>
<span class="co">#&gt; 64       64     A       77         1</span>
<span class="co">#&gt; 65       65     A       48         1</span>
<span class="co">#&gt; 66       66     A      127         1</span>
<span class="co">#&gt; 67       67     A       41         1</span>
<span class="co">#&gt; 68       68     A      226         1</span>
<span class="co">#&gt; 69       69     A       76         1</span>
<span class="co">#&gt; 70       70     A      217         1</span>
<span class="co">#&gt; 71       71     A      181         1</span>
<span class="co">#&gt; 72       72     A      112         1</span>
<span class="co">#&gt; 73       73     A      212         1</span>
<span class="co">#&gt; 74       74     A      147         1</span>
<span class="co">#&gt; 75       75     A      103         1</span>
<span class="co">#&gt; 76       76     A      113         1</span>
<span class="co">#&gt; 77       77     A      169         1</span>
<span class="co">#&gt; 78       78     A      404         1</span>
<span class="co">#&gt; 79       79     A      330         1</span>
<span class="co">#&gt; 80       80     A       74         1</span>
<span class="co">#&gt; 81       81     A      373         1</span>
<span class="co">#&gt; 82       82     A      568         0</span>
<span class="co">#&gt; 83       83     A      304         1</span>
<span class="co">#&gt; 84       84     A      158         1</span>
<span class="co">#&gt; 85       85     A      117         1</span>
<span class="co">#&gt; 86       86     A      409         0</span>
<span class="co">#&gt; 87       87     A      293         1</span>
<span class="co">#&gt; 88       88     A      163         1</span>
<span class="co">#&gt; 89       89     A      299         1</span>
<span class="co">#&gt; 90       90     A      166         1</span>
<span class="co">#&gt; 91       91     A      211         1</span>
<span class="co">#&gt; 92       92     A       84         1</span>
<span class="co">#&gt; 93       93     A      275         1</span>
<span class="co">#&gt; 94       94     A       59         1</span>
<span class="co">#&gt; 95       95     A       61         1</span>
<span class="co">#&gt; 96       96     A      217         1</span>
<span class="co">#&gt; 97       97     A      186         1</span>
<span class="co">#&gt; 98       98     A      275         1</span>
<span class="co">#&gt; 99       99     A      174         1</span>
<span class="co">#&gt; 100     100     A      183         1</span>
<span class="co">#&gt; 101     101     A      130         1</span>
<span class="co">#&gt; 102     102     A      163         1</span>
<span class="co">#&gt; 103     103     A      136         1</span>
<span class="co">#&gt; 104     104     A       38         1</span>
<span class="co">#&gt; 105     105     A      157         1</span>
<span class="co">#&gt; 106     106     A      372         1</span>
<span class="co">#&gt; 107     107     A       51         1</span>
<span class="co">#&gt; 108     108     A      172         1</span>
<span class="co">#&gt; 109     109     A       75         1</span>
<span class="co">#&gt; 110     110     A       92         1</span>
<span class="co">#&gt; 111     111     A       21         1</span>
<span class="co">#&gt; 112     112     A      464         0</span>
<span class="co">#&gt; 113     113     A       27         1</span>
<span class="co">#&gt; 114     114     A      104         1</span>
<span class="co">#&gt; 115     115     A      265         1</span>
<span class="co">#&gt; 116     116     A      213         1</span>
<span class="co">#&gt; 117     117     A      239         1</span>
<span class="co">#&gt; 118     118     A      126         1</span>
<span class="co">#&gt; 119     119     A      135         1</span>
<span class="co">#&gt; 120     120     A      133         1</span>
<span class="co">#&gt; 121     121     A       35         1</span>
<span class="co">#&gt; 122     122     A      431         1</span>
<span class="co">#&gt; 123     123     A      151         1</span>
<span class="co">#&gt; 124     124     A       92         1</span>
<span class="co">#&gt; 125     125     A      372         1</span>
<span class="co">#&gt; 126     126     A      108         1</span>
<span class="co">#&gt; 127     127     A        4         1</span>
<span class="co">#&gt; 128     128     A       89         1</span>
<span class="co">#&gt; 129     129     A       95         1</span>
<span class="co">#&gt; 130     130     A      193         1</span>
<span class="co">#&gt; 131     131     A      176         1</span>
<span class="co">#&gt; 132     132     A      172         1</span>
<span class="co">#&gt; 133     133     A      108         1</span>
<span class="co">#&gt; 134     134     A      212         1</span>
<span class="co">#&gt; 135     135     A      325         1</span>
<span class="co">#&gt; 136     136     A      529         1</span>
<span class="co">#&gt; 137     137     A      213         1</span>
<span class="co">#&gt; 138     138     A       67         1</span>
<span class="co">#&gt; 139     139     A      125         1</span>
<span class="co">#&gt; 140     140     A      514         1</span>
<span class="co">#&gt; 141     141     A       96         1</span>
<span class="co">#&gt; 142     142     A      165         1</span>
<span class="co">#&gt; 143     143     A       70         1</span>
<span class="co">#&gt; 144     144     A       15         1</span>
<span class="co">#&gt; 145     145     A      457         1</span>
<span class="co">#&gt; 146     146     A      311         1</span>
<span class="co">#&gt; 147     147     A      150         1</span>
<span class="co">#&gt; 148     148     A      210         1</span>
<span class="co">#&gt; 149     149     A      225         1</span>
<span class="co">#&gt; 150     150     A      421         0</span>
<span class="co">#&gt; 151     151     A      262         1</span>
<span class="co">#&gt; 152     152     A      148         1</span>
<span class="co">#&gt; 153     153     A      641         0</span>
<span class="co">#&gt; 154     154     A       72         1</span>
<span class="co">#&gt; 155     155     A      258         1</span>
<span class="co">#&gt; 156     156     A      213         1</span>
<span class="co">#&gt; 157     157     A      110         1</span>
<span class="co">#&gt; 158     158     A       43         1</span>
<span class="co">#&gt; 159     159     A       55         1</span>
<span class="co">#&gt; 160     160     A       87         1</span>
<span class="co">#&gt; 161     161     A      140         1</span>
<span class="co">#&gt; 162     162     A      386         1</span>
<span class="co">#&gt; 163     163     A      122         1</span>
<span class="co">#&gt; 164     164     A      169         1</span>
<span class="co">#&gt; 165     165     A       35         1</span>
<span class="co">#&gt; 166     166     A      106         1</span>
<span class="co">#&gt; 167     167     A      297         1</span>
<span class="co">#&gt; 168     168     A      169         1</span>
<span class="co">#&gt; 169     169     A      470         0</span>
<span class="co">#&gt; 170     170     A      119         1</span>
<span class="co">#&gt; 171     171     A        3         1</span>
<span class="co">#&gt; 172     172     A      152         1</span>
<span class="co">#&gt; 173     173     A      443         1</span>
<span class="co">#&gt; 174     174     A      342         1</span>
<span class="co">#&gt; 175     175     A      142         1</span>
<span class="co">#&gt; 176     176     A      330         1</span>
<span class="co">#&gt; 177     177     A       55         1</span>
<span class="co">#&gt; 178     178     A      330         1</span>
<span class="co">#&gt; 179     179     A      165         1</span>
<span class="co">#&gt; 180     180     A      100         1</span>
<span class="co">#&gt; 181     181     A      564         1</span>
<span class="co">#&gt; 182     182     A       62         1</span>
<span class="co">#&gt; 183     183     A      397         0</span>
<span class="co">#&gt; 184     184     A      105         1</span>
<span class="co">#&gt; 185     185     A      213         1</span>
<span class="co">#&gt; 186     186     A      187         1</span>
<span class="co">#&gt; 187     187     A       67         1</span>
<span class="co">#&gt; 188     188     A      103         1</span>
<span class="co">#&gt; 189     189     A      146         1</span>
<span class="co">#&gt; 190     190     A      161         1</span>
<span class="co">#&gt; 191     191     A      402         1</span>
<span class="co">#&gt; 192     192     A       63         1</span>
<span class="co">#&gt; 193     193     A      128         1</span>
<span class="co">#&gt; 194     194     A      129         1</span>
<span class="co">#&gt; 195     195     A      124         1</span>
<span class="co">#&gt; 196     196     A      378         0</span>
<span class="co">#&gt; 197     197     A      230         1</span>
<span class="co">#&gt; 198     198     A      375         0</span>
<span class="co">#&gt; 199     199     A      332         1</span>
<span class="co">#&gt; 200     200     A      330         1</span>
<span class="co">#&gt; 201     201     A      537         1</span>
<span class="co">#&gt; 202     202     A       76         1</span>
<span class="co">#&gt; 203     203     A      324         1</span>
<span class="co">#&gt; 204     204     A      140         1</span>
<span class="co">#&gt; 205     205     A      198         1</span>
<span class="co">#&gt; 206     206     A       30         1</span>
<span class="co">#&gt; 207     207     A      173         1</span>
<span class="co">#&gt; 208     208     A      207         1</span>
<span class="co">#&gt; 209     209     A      128         1</span>
<span class="co">#&gt; 210     210     A       55         1</span>
<span class="co">#&gt; 211     211     A      310         1</span>
<span class="co">#&gt; 212     212     A      451         0</span>
<span class="co">#&gt; 213     213     A      286         1</span>
<span class="co">#&gt; 214     214     A       40         1</span>
<span class="co">#&gt; 215     215     A      179         1</span>
<span class="co">#&gt; 216     216     A      173         1</span>
<span class="co">#&gt; 217     217     A       56         1</span>
<span class="co">#&gt; 218     218     A      323         1</span>
<span class="co">#&gt; 219     219     A      202         1</span>
<span class="co">#&gt; 220     220     A        7         1</span>
<span class="co">#&gt; 221     221     A      129         1</span>
<span class="co">#&gt; 222     222     A       76         1</span>
<span class="co">#&gt; 223     223     A      237         1</span>
<span class="co">#&gt; 224     224     A      368         1</span>
<span class="co">#&gt; 225     225     A      171         1</span>
<span class="co">#&gt; 226     226     A       70         1</span>
<span class="co">#&gt; 227     227     A      436         1</span>
<span class="co">#&gt; 228     228     A       23         1</span>
<span class="co">#&gt; 229     229     A      103         1</span>
<span class="co">#&gt; 230     230     A      150         1</span>
<span class="co">#&gt; 231     231     A      291         1</span>
<span class="co">#&gt; 232     232     A       36         1</span>
<span class="co">#&gt; 233     233     A       11         1</span>
<span class="co">#&gt; 234     234     A      132         1</span>
<span class="co">#&gt; 235     235     A      367         1</span>
<span class="co">#&gt; 236     236     A      293         1</span>
<span class="co">#&gt; 237     237     A      153         1</span>
<span class="co">#&gt; 238     238     A       48         1</span>
<span class="co">#&gt; 239     239     A      110         1</span>
<span class="co">#&gt; 240     240     A      192         1</span>
<span class="co">#&gt; 241     241     A      135         1</span>
<span class="co">#&gt; 242     242     A      328         1</span>
<span class="co">#&gt; 243     243     A      173         1</span>
<span class="co">#&gt; 244     244     A      190         1</span>
<span class="co">#&gt; 245     245     A       61         1</span>
<span class="co">#&gt; 246     246     A      466         1</span>
<span class="co">#&gt; 247     247     A      464         1</span>
<span class="co">#&gt; 248     248     A      274         1</span>
<span class="co">#&gt; 249     249     A      355         1</span>
<span class="co">#&gt; 250     250     A       11         1</span>
<span class="co">#&gt; 251     251     B      232         1</span>
<span class="co">#&gt; 252     252     B        6         1</span>
<span class="co">#&gt; 253     253     B       44         1</span>
<span class="co">#&gt; 254     254     B      227         1</span>
<span class="co">#&gt; 255     255     B      125         1</span>
<span class="co">#&gt; 256     256     B        6         1</span>
<span class="co">#&gt; 257     257     B      194         1</span>
<span class="co">#&gt; 258     258     B      272         1</span>
<span class="co">#&gt; 259     259     B      480         0</span>
<span class="co">#&gt; 260     260     B      284         1</span>
<span class="co">#&gt; 261     261     B       71         1</span>
<span class="co">#&gt; 262     262     B      461         0</span>
<span class="co">#&gt; 263     263     B      492         1</span>
<span class="co">#&gt; 264     264     B      125         1</span>
<span class="co">#&gt; 265     265     B      460         1</span>
<span class="co">#&gt; 266     266     B      381         0</span>
<span class="co">#&gt; 267     267     B      201         1</span>
<span class="co">#&gt; 268     268     B      385         0</span>
<span class="co">#&gt; 269     269     B      660         0</span>
<span class="co">#&gt; 270     270     B      539         0</span>
<span class="co">#&gt; 271     271     B      264         1</span>
<span class="co">#&gt; 272     272     B      215         1</span>
<span class="co">#&gt; 273     273     B      227         1</span>
<span class="co">#&gt; 274     274     B      170         1</span>
<span class="co">#&gt; 275     275     B      441         0</span>
<span class="co">#&gt; 276     276     B      543         0</span>
<span class="co">#&gt; 277     277     B        7         1</span>
<span class="co">#&gt; 278     278     B      310         1</span>
<span class="co">#&gt; 279     279     B      505         0</span>
<span class="co">#&gt; 280     280     B      253         1</span>
<span class="co">#&gt; 281     281     B      240         1</span>
<span class="co">#&gt; 282     282     B      216         1</span>
<span class="co">#&gt; 283     283     B      275         1</span>
<span class="co">#&gt; 284     284     B      531         1</span>
<span class="co">#&gt; 285     285     B       49         1</span>
<span class="co">#&gt; 286     286     B       81         1</span>
<span class="co">#&gt; 287     287     B      712         0</span>
<span class="co">#&gt; 288     288     B      488         0</span>
<span class="co">#&gt; 289     289     B      279         1</span>
<span class="co">#&gt; 290     290     B      145         1</span>
<span class="co">#&gt; 291     291     B      246         1</span>
<span class="co">#&gt; 292     292     B      411         0</span>
<span class="co">#&gt; 293     293     B       88         1</span>
<span class="co">#&gt; 294     294     B       62         1</span>
<span class="co">#&gt; 295     295     B      403         1</span>
<span class="co">#&gt; 296     296     B      274         1</span>
<span class="co">#&gt; 297     297     B      344         1</span>
<span class="co">#&gt; 298     298     B      367         0</span>
<span class="co">#&gt; 299     299     B      620         0</span>
<span class="co">#&gt; 300     300     B      313         1</span>
<span class="co">#&gt; 301     301     B      584         0</span>
<span class="co">#&gt; 302     302     B      236         1</span>
<span class="co">#&gt; 303     303     B      605         0</span>
<span class="co">#&gt; 304     304     B      253         1</span>
<span class="co">#&gt; 305     305     B      227         1</span>
<span class="co">#&gt; 306     306     B      230         1</span>
<span class="co">#&gt; 307     307     B      505         0</span>
<span class="co">#&gt; 308     308     B      407         0</span>
<span class="co">#&gt; 309     309     B      301         1</span>
<span class="co">#&gt; 310     310     B      535         1</span>
<span class="co">#&gt; 311     311     B      336         1</span>
<span class="co">#&gt; 312     312     B       87         1</span>
<span class="co">#&gt; 313     313     B      525         0</span>
<span class="co">#&gt; 314     314     B      197         1</span>
<span class="co">#&gt; 315     315     B      386         0</span>
<span class="co">#&gt; 316     316     B      451         1</span>
<span class="co">#&gt; 317     317     B      454         0</span>
<span class="co">#&gt; 318     318     B      437         1</span>
<span class="co">#&gt; 319     319     B      239         1</span>
<span class="co">#&gt; 320     320     B      625         1</span>
<span class="co">#&gt; 321     321     B      269         1</span>
<span class="co">#&gt; 322     322     B      671         0</span>
<span class="co">#&gt; 323     323     B      394         1</span>
<span class="co">#&gt; 324     324     B       65         1</span>
<span class="co">#&gt; 325     325     B      239         1</span>
<span class="co">#&gt; 326     326     B      355         1</span>
<span class="co">#&gt; 327     327     B      252         1</span>
<span class="co">#&gt; 328     328     B      161         1</span>
<span class="co">#&gt; 329     329     B      544         0</span>
<span class="co">#&gt; 330     330     B      337         1</span>
<span class="co">#&gt; 331     331     B      144         1</span>
<span class="co">#&gt; 332     332     B      468         0</span>
<span class="co">#&gt; 333     333     B      144         1</span>
<span class="co">#&gt; 334     334     B      310         1</span>
<span class="co">#&gt; 335     335     B      557         0</span>
<span class="co">#&gt; 336     336     B      265         1</span>
<span class="co">#&gt; 337     337     B      547         0</span>
<span class="co">#&gt; 338     338     B      412         0</span>
<span class="co">#&gt; 339     339     B      216         1</span>
<span class="co">#&gt; 340     340     B      539         1</span>
<span class="co">#&gt; 341     341     B       67         1</span>
<span class="co">#&gt; 342     342     B       62         1</span>
<span class="co">#&gt; 343     343     B      367         0</span>
<span class="co">#&gt; 344     344     B      441         0</span>
<span class="co">#&gt; 345     345     B      490         1</span>
<span class="co">#&gt; 346     346     B       84         1</span>
<span class="co">#&gt; 347     347     B      190         1</span>
<span class="co">#&gt; 348     348     B      429         1</span>
<span class="co">#&gt; 349     349     B      171         1</span>
<span class="co">#&gt; 350     350     B      501         0</span>
<span class="co">#&gt; 351     351     B      496         0</span>
<span class="co">#&gt; 352     352     B      178         1</span>
<span class="co">#&gt; 353     353     B      632         0</span>
<span class="co">#&gt; 354     354     B      401         1</span>
<span class="co">#&gt; 355     355     B      408         0</span>
<span class="co">#&gt; 356     356     B      604         0</span>
<span class="co">#&gt; 357     357     B      186         1</span>
<span class="co">#&gt; 358     358     B      721         0</span>
<span class="co">#&gt; 359     359     B      424         1</span>
<span class="co">#&gt; 360     360     B      336         1</span>
<span class="co">#&gt; 361     361     B      306         1</span>
<span class="co">#&gt; 362     362     B      288         1</span>
<span class="co">#&gt; 363     363     B      257         1</span>
<span class="co">#&gt; 364     364     B      494         1</span>
<span class="co">#&gt; 365     365     B      387         0</span>
<span class="co">#&gt; 366     366     B      136         1</span>
<span class="co">#&gt; 367     367     B      565         0</span>
<span class="co">#&gt; 368     368     B      240         1</span>
<span class="co">#&gt; 369     369     B       13         1</span>
<span class="co">#&gt; 370     370     B      402         0</span>
<span class="co">#&gt; 371     371     B      322         1</span>
<span class="co">#&gt; 372     372     B      541         1</span>
<span class="co">#&gt; 373     373     B      191         1</span>
<span class="co">#&gt; 374     374     B      404         0</span>
<span class="co">#&gt; 375     375     B      464         1</span>
<span class="co">#&gt; 376     376     B      588         0</span>
<span class="co">#&gt; 377     377     B      480         0</span>
<span class="co">#&gt; 378     378     B      120         1</span>
<span class="co">#&gt; 379     379     B      217         1</span>
<span class="co">#&gt; 380     380     B      420         0</span>
<span class="co">#&gt; 381     381     B      210         1</span>
<span class="co">#&gt; 382     382     B       10         1</span>
<span class="co">#&gt; 383     383     B      539         0</span>
<span class="co">#&gt; 384     384     B      100         1</span>
<span class="co">#&gt; 385     385     B      436         1</span>
<span class="co">#&gt; 386     386     B      258         1</span>
<span class="co">#&gt; 387     387     B       60         1</span>
<span class="co">#&gt; 388     388     B      265         1</span>
<span class="co">#&gt; 389     389     B      386         1</span>
<span class="co">#&gt; 390     390     B      574         0</span>
<span class="co">#&gt; 391     391     B      254         1</span>
<span class="co">#&gt; 392     392     B      233         1</span>
<span class="co">#&gt; 393     393     B      466         0</span>
<span class="co">#&gt; 394     394     B      625         0</span>
<span class="co">#&gt; 395     395     B      366         0</span>
<span class="co">#&gt; 396     396     B      449         1</span>
<span class="co">#&gt; 397     397     B      148         1</span>
<span class="co">#&gt; 398     398     B      283         1</span>
<span class="co">#&gt; 399     399     B      280         1</span>
<span class="co">#&gt; 400     400     B      363         1</span>
<span class="co">#&gt; 401     401     B      616         0</span>
<span class="co">#&gt; 402     402     B      397         0</span>
<span class="co">#&gt; 403     403     B       98         1</span>
<span class="co">#&gt; 404     404     B      528         0</span>
<span class="co">#&gt; 405     405     B      476         1</span>
<span class="co">#&gt; 406     406     B      335         1</span>
<span class="co">#&gt; 407     407     B      278         1</span>
<span class="co">#&gt; 408     408     B      260         1</span>
<span class="co">#&gt; 409     409     B      590         1</span>
<span class="co">#&gt; 410     410     B      485         0</span>
<span class="co">#&gt; 411     411     B      520         0</span>
<span class="co">#&gt; 412     412     B      542         0</span>
<span class="co">#&gt; 413     413     B      136         1</span>
<span class="co">#&gt; 414     414     B      289         1</span>
<span class="co">#&gt; 415     415     B      247         1</span>
<span class="co">#&gt; 416     416     B      126         1</span>
<span class="co">#&gt; 417     417     B      357         1</span>
<span class="co">#&gt; 418     418     B       89         1</span>
<span class="co">#&gt; 419     419     B      596         1</span>
<span class="co">#&gt; 420     420     B      121         1</span>
<span class="co">#&gt; 421     421     B       98         1</span>
<span class="co">#&gt; 422     422     B      541         1</span>
<span class="co">#&gt; 423     423     B      351         1</span>
<span class="co">#&gt; 424     424     B      128         1</span>
<span class="co">#&gt; 425     425     B       37         1</span>
<span class="co">#&gt; 426     426     B      216         1</span>
<span class="co">#&gt; 427     427     B      212         1</span>
<span class="co">#&gt; 428     428     B      376         1</span>
<span class="co">#&gt; 429     429     B      323         1</span>
<span class="co">#&gt; 430     430     B      646         1</span>
<span class="co">#&gt; 431     431     B      159         1</span>
<span class="co">#&gt; 432     432     B       91         1</span>
<span class="co">#&gt; 433     433     B      468         1</span>
<span class="co">#&gt; 434     434     B       43         1</span>
<span class="co">#&gt; 435     435     B      396         1</span>
<span class="co">#&gt; 436     436     B      360         1</span>
<span class="co">#&gt; 437     437     B      537         0</span>
<span class="co">#&gt; 438     438     B      231         1</span>
<span class="co">#&gt; 439     439     B      449         0</span>
<span class="co">#&gt; 440     440     B      400         1</span>
<span class="co">#&gt; 441     441     B      244         1</span>
<span class="co">#&gt; 442     442     B      183         1</span>
<span class="co">#&gt; 443     443     B      380         0</span>
<span class="co">#&gt; 444     444     B      208         1</span>
<span class="co">#&gt; 445     445     B      404         1</span>
<span class="co">#&gt; 446     446     B      468         0</span>
<span class="co">#&gt; 447     447     B      447         1</span>
<span class="co">#&gt; 448     448     B      313         1</span>
<span class="co">#&gt; 449     449     B      447         1</span>
<span class="co">#&gt; 450     450     B      705         0</span>
<span class="co">#&gt; 451     451     B      326         1</span>
<span class="co">#&gt; 452     452     B      401         1</span>
<span class="co">#&gt; 453     453     B      158         1</span>
<span class="co">#&gt; 454     454     B      194         1</span>
<span class="co">#&gt; 455     455     B      564         1</span>
<span class="co">#&gt; 456     456     B      296         1</span>
<span class="co">#&gt; 457     457     B      129         1</span>
<span class="co">#&gt; 458     458     B      116         1</span>
<span class="co">#&gt; 459     459     B      303         1</span>
<span class="co">#&gt; 460     460     B      727         0</span>
<span class="co">#&gt; 461     461     B      374         1</span>
<span class="co">#&gt; 462     462     B      236         1</span>
<span class="co">#&gt; 463     463     B      167         1</span>
<span class="co">#&gt; 464     464     B      563         1</span>
<span class="co">#&gt; 465     465     B      535         0</span>
<span class="co">#&gt; 466     466     B      398         1</span>
<span class="co">#&gt; 467     467     B      101         1</span>
<span class="co">#&gt; 468     468     B       31         1</span>
<span class="co">#&gt; 469     469     B      465         0</span>
<span class="co">#&gt; 470     470     B      413         0</span>
<span class="co">#&gt; 471     471     B      126         1</span>
<span class="co">#&gt; 472     472     B      388         1</span>
<span class="co">#&gt; 473     473     B      100         1</span>
<span class="co">#&gt; 474     474     B      383         1</span>
<span class="co">#&gt; 475     475     B      215         1</span>
<span class="co">#&gt; 476     476     B      536         0</span>
<span class="co">#&gt; 477     477     B      424         0</span>
<span class="co">#&gt; 478     478     B      119         1</span>
<span class="co">#&gt; 479     479     B       94         1</span>
<span class="co">#&gt; 480     480     B      138         1</span>
<span class="co">#&gt; 481     481     B      438         0</span>
<span class="co">#&gt; 482     482     B      211         1</span>
<span class="co">#&gt; 483     483     B      135         1</span>
<span class="co">#&gt; 484     484     B      587         1</span>
<span class="co">#&gt; 485     485     B       50         1</span>
<span class="co">#&gt; 486     486     B      314         1</span>
<span class="co">#&gt; 487     487     B       70         1</span>
<span class="co">#&gt; 488     488     B      425         1</span>
<span class="co">#&gt; 489     489     B      552         0</span>
<span class="co">#&gt; 490     490     B      681         0</span>
<span class="co">#&gt; 491     491     B      385         0</span>
<span class="co">#&gt; 492     492     B      338         1</span>
<span class="co">#&gt; 493     493     B      367         0</span>
<span class="co">#&gt; 494     494     B      273         1</span>
<span class="co">#&gt; 495     495     B      181         1</span>
<span class="co">#&gt; 496     496     B       35         1</span>
<span class="co">#&gt; 497     497     B      403         1</span>
<span class="co">#&gt; 498     498     B      462         1</span>
<span class="co">#&gt; 499     499     B       31         1</span>
<span class="co">#&gt; 500     500     B      421         1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $config$time_var</span>
<span class="co">#&gt; [1] "PFS_days"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $config$event_var</span>
<span class="co">#&gt; [1] "PFS_event"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $config$weight_var</span>
<span class="co">#&gt; [1] ""</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $config$model.type</span>
<span class="co">#&gt; [1] "Common shape"      "Independent shape" "Separate"         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $config$distr</span>
<span class="co">#&gt; [1] "exp"      "weibull"  "gompertz" "lnorm"    "llogis"   "gengamma" "gamma"   </span>
<span class="co">#&gt; [8] "genf"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $config$int_name</span>
<span class="co">#&gt; [1] "A"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $config$strata_var</span>
<span class="co">#&gt; [1] "ARMCD"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $config$ref_name</span>
<span class="co">#&gt; [1] "B"</span></pre></div>
</div>
<div id="estimate-survival-from-the-models-and-plot-the-curves" class="section level1">
<h1 class="hasAnchor">
<a href="#estimate-survival-from-the-models-and-plot-the-curves" class="anchor"></a>Estimate survival from the models and plot the curves</h1>
<p>Survival at a given time, t, is estimated as follows:</p>
<p><span class="math display">\[ S(t) = P({T&gt;t}) = 1 - F(t) \]</span></p>
<p>Where F(t) is the cumulative distribution function.</p>
<p>To cross check survival estimates in Excel models, the following functions in R can be used to estimate the cumulative distribution function at given time points for each distribution explored in this package (the estimates from the cumulative distribution function can then be subtracted from 1 to estimate the survival probability):</p>
<ul>
<li><p>Exponential: <tt>pexp()</tt></p></li>
<li><p>Weibull: <tt>pweibull()</tt></p></li>
<li><p>Gompertz: <tt>pgompertz()</tt></p></li>
<li><p>Log-normal: <tt>plnorm()</tt></p></li>
<li><p>Log-logistic: <tt>pllogis()</tt></p></li>
<li><p>Generalized gamma: <tt>pgengamma()</tt></p></li>
<li><p>Gamma: <tt>pgamma()</tt></p></li>
<li><p>Generalized F: <tt>pgenf()</tt></p></li>
</ul>
<p>The parameters outputted from each of the fitted models are used as inputs to these functions. The code below gives some examples.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="co"># Landmark survival</span>

<span class="co"># vector of times to estimate survival (days)</span>
<span class="va">landmark_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span><span class="op">)</span>


<span class="co"># Example 1: intervention arm, Weibull distribution, common shape model</span>
<span class="va">surv_comshp_weibull_int</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">pweibull</a></span><span class="op">(</span><span class="va">landmark_times</span>,
                                        shape <span class="op">=</span> <span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">parameters_vector</span><span class="op">[</span><span class="st">"comshp.weibull.shape.int"</span><span class="op">]</span>,
                                        scale <span class="op">=</span> <span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">parameters_vector</span><span class="op">[</span><span class="st">"comshp.weibull.scale.int"</span><span class="op">]</span><span class="op">)</span>
<span class="va">surv_comshp_weibull_int</span>
<span class="co">#&gt; [1] 1.0000000 0.7234631 0.4286008 0.2259593</span>


<span class="co"># Example 2: intervention arm, log-normal distribution, separate model</span>
<span class="va">surv_sep_lnorm_int</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">plnorm</a></span><span class="op">(</span><span class="va">landmark_times</span>,
                                 meanlog <span class="op">=</span> <span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">parameters_vector</span><span class="op">[</span><span class="st">"sep.lnorm.meanlog.int"</span><span class="op">]</span>,
                                 sdlog <span class="op">=</span> <span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">parameters_vector</span><span class="op">[</span><span class="st">"sep.lnorm.sdlog.int"</span><span class="op">]</span><span class="op">)</span>
<span class="va">surv_sep_lnorm_int</span>
<span class="co">#&gt; [1] 1.0000000 0.6732037 0.3817230 0.2297939</span>


<span class="co"># Example 3: reference arm, Generalized Gamma distribution, independent shape model</span>
<span class="va">surv_indshp_gengamma_ref</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu">pgengamma</span><span class="op">(</span><span class="va">landmark_times</span>,
                                          mu <span class="op">=</span> <span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">parameters_vector</span><span class="op">[</span><span class="st">"indshp.gengamma.mu.ref"</span><span class="op">]</span>,
                                          sigma <span class="op">=</span> <span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">parameters_vector</span><span class="op">[</span><span class="st">"indshp.gengamma.sigma.ref"</span><span class="op">]</span>,
                                          Q <span class="op">=</span> <span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">parameters_vector</span><span class="op">[</span><span class="st">"indshp.gengamma.Q.ref"</span><span class="op">]</span><span class="op">)</span>
<span class="va">surv_indshp_gengamma_ref</span>
<span class="co">#&gt; [1] 1.0000000 0.8790137 0.7164446 0.5563410</span></pre></div>
<p>To simplify these actions a helper function is included in the <code>flexsurvPlus</code> package that will extract these values directly. This will calculate the same values as above.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">

<span class="co"># repeat the prior example for landmark times</span>

<span class="va">landmarks_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summaryPSM.html">summaryPSM</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">psm_PFS_all</span>,
                        types <span class="op">=</span> <span class="st">"survival"</span>,
                        t <span class="op">=</span> <span class="va">landmark_times</span>
                        <span class="op">)</span>

<span class="va">landmarks_df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Model</span> <span class="op">==</span> <span class="st">"Common shape"</span>, <span class="va">Dist</span> <span class="op">==</span> <span class="st">"Weibull"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 8 × 11</span>
<span class="co">#&gt;   Model    ModelF Dist  DistF distr Strata StrataName type  variable  time value</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;ord&gt;  &lt;chr&gt; &lt;ord&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Common … Commo… Weib… Weib… weib… Inter… A          surv… est          0 1    </span>
<span class="co">#&gt; 2 Common … Commo… Weib… Weib… weib… Inter… A          surv… est        100 0.723</span>
<span class="co">#&gt; 3 Common … Commo… Weib… Weib… weib… Inter… A          surv… est        200 0.429</span>
<span class="co">#&gt; 4 Common … Commo… Weib… Weib… weib… Inter… A          surv… est        300 0.226</span>
<span class="co">#&gt; 5 Common … Commo… Weib… Weib… weib… Refer… B          surv… est          0 1    </span>
<span class="co">#&gt; 6 Common … Commo… Weib… Weib… weib… Refer… B          surv… est        100 0.879</span>
<span class="co">#&gt; 7 Common … Commo… Weib… Weib… weib… Refer… B          surv… est        200 0.713</span>
<span class="co">#&gt; 8 Common … Commo… Weib… Weib… weib… Refer… B          surv… est        300 0.553</span></pre></div>
<p>The same functions can be used to generate the data required to plot the survival curves, overlaid on top of the KM plot. The time argument should reflect how long you want to the extrapolate for and the unit of time is the same as the input data (in this example, days).</p>
<div class="sourceCode" id="cb7"><pre class="downlit">

<span class="co"># Plot the common shape models (Weibull distribution) with the Kaplan-Meier</span>

<span class="co"># vector of times to estimate survival (days)</span>
<span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1000</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>


<span class="co"># Survival probabilities: intervention arm, Weibull distribution, common shape model</span>
<span class="va">surv_comshp_weibull_int</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">pweibull</a></span><span class="op">(</span><span class="va">times</span>,
                                  shape <span class="op">=</span> <span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">parameters_vector</span><span class="op">[</span><span class="st">"comshp.weibull.shape.int"</span><span class="op">]</span>,
                                  scale <span class="op">=</span> <span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">parameters_vector</span><span class="op">[</span><span class="st">"comshp.weibull.scale.int"</span><span class="op">]</span><span class="op">)</span>

<span class="co"># Survival probabilities: reference arm, Weibull distribution, common shape model</span>
<span class="va">surv_comshp_weibull_ref</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html">pweibull</a></span><span class="op">(</span><span class="va">times</span>,
                                  shape <span class="op">=</span> <span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">parameters_vector</span><span class="op">[</span><span class="st">"comshp.weibull.shape.ref"</span><span class="op">]</span>,
                                  scale <span class="op">=</span> <span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">parameters_vector</span><span class="op">[</span><span class="st">"comshp.weibull.scale.ref"</span><span class="op">]</span><span class="op">)</span>

<span class="co"># Create two data frames that include the survival probablaities and times</span>
<span class="va">surv_comshp_weibull_int_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Time <span class="op">=</span> <span class="va">times</span>,
                                            Surv <span class="op">=</span> <span class="va">surv_comshp_weibull_int</span>,
                                            Trt <span class="op">=</span> <span class="st">"Intervention"</span><span class="op">)</span>
<span class="va">surv_comshp_weibull_ref_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Time <span class="op">=</span> <span class="va">times</span>,
                                            Surv <span class="op">=</span> <span class="va">surv_comshp_weibull_ref</span>,
                                            Trt <span class="op">=</span> <span class="st">"Reference"</span><span class="op">)</span>

<span class="co"># Plot Kaplan-Meier</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">km.est.PFS</span>, 
     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">blue</span>, <span class="va">pink</span><span class="op">)</span>, <span class="co"># plot colours</span>
     lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="co"># line type</span>
     xlab <span class="op">=</span> <span class="st">"Time (Days)"</span>, <span class="co"># x-axis label</span>
     ylab <span class="op">=</span> <span class="st">"Progression-free survival"</span>, <span class="co"># y-axis label</span>
     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span> 

<span class="co"># Add legend</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">500</span>, 
       y <span class="op">=</span> <span class="fl">.9</span>, 
       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Arm A"</span>, <span class="st">"Arm B"</span><span class="op">)</span>, 
       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, 
       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">blue</span>, <span class="va">pink</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Add model estimates</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">surv_comshp_weibull_int_times</span><span class="op">$</span><span class="va">Time</span>, y <span class="op">=</span> <span class="va">surv_comshp_weibull_int_times</span><span class="op">$</span><span class="va">Surv</span>, col <span class="op">=</span> <span class="va">blue</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">surv_comshp_weibull_ref_times</span><span class="op">$</span><span class="va">Time</span>, y <span class="op">=</span> <span class="va">surv_comshp_weibull_ref_times</span><span class="op">$</span><span class="va">Surv</span>, col <span class="op">=</span> <span class="va">pink</span><span class="op">)</span></pre></div>
<p><img src="Fitting_models_in_R_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>The same helper function can also be used to generate plots.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">

<span class="co"># repeat the prior example for plot data</span>

<span class="va">plot_esurv_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summaryPSM.html">summaryPSM</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">psm_PFS_all</span>,
                            types <span class="op">=</span> <span class="st">"survival"</span>,
                            t <span class="op">=</span> <span class="va">times</span>
                            <span class="op">)</span>

<span class="co"># a similar function will estimate the values needed for KM estimates</span>

<span class="va">plot_km_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summaryKM.html">summaryKM</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">PFS_data</span>,
                        time_var<span class="op">=</span><span class="st">"PFS_days"</span>,
                        event_var<span class="op">=</span><span class="st">"PFS_event"</span>,
                        strata_var <span class="op">=</span> <span class="st">"ARMCD"</span>,
                        int_name<span class="op">=</span><span class="st">"A"</span>,
                        ref_name <span class="op">=</span> <span class="st">"B"</span>,
                        types <span class="op">=</span> <span class="st">"survival"</span>
                        <span class="op">)</span>
                      

<span class="co"># can then combine these to plot</span>

<span class="va">plot_esurv_df</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Model</span> <span class="op">==</span> <span class="st">"Common shape"</span>,
                          <span class="va">Dist</span> <span class="op">==</span> <span class="st">"weibull"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">plot_km_df</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"survival"</span>, <span class="va">variable</span> <span class="op">==</span> <span class="st">"est"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Model_Dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">Model</span>, <span class="va">Dist</span>, sep <span class="op">=</span> <span class="st">" - "</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">StrataName</span>, linetype <span class="op">=</span> <span class="va">Model_Dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_step</a></span><span class="op">(</span>data <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">Model</span> <span class="op">==</span> <span class="st">"Kaplan Meier"</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">Model</span> <span class="op">!=</span> <span class="st">"Kaplan Meier"</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span> </pre></div>
<p><img src="Fitting_models_in_R_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
<div id="adressing-uncertainty---bootstrapping" class="section level1">
<h1 class="hasAnchor">
<a href="#adressing-uncertainty---bootstrapping" class="anchor"></a>Adressing uncertainty - Bootstrapping</h1>
<p>Bootstrapping has been used to estimate the uncertainty of the parameters from the survival models. Boostrapping is used for two reasons motivated by intent of this package to support further modeling in excel. 1. To simplify and accelerate calculations in excel while maintaining correlations between parameters (as is commonly done for NMA) 2. To maintain correlations across multiple endpoints (see separate vignette for details)</p>
<p>Bootstrapping involves:</p>
<ol style="list-style-type: decimal">
<li>Sampling, with replacement, from all patients</li>
<li>Estimating all specified parametric survival models</li>
</ol>
<p>This procedure is repeated multiple times to obtain a distribution of parameters. For this example, bootstrap estimates of the parameters were calculated using the <tt>boot</tt> package. An argument for the <tt>boot</tt> function is <tt>statistic</tt> which is a function which when applied to data returns a vector containing the statistic(s) of interest. The <tt>bootPSM</tt> function in the <tt>flexsurvPlus</tt> package can be used for this purpose.</p>
<p>The inputs for the <tt>bootPSM</tt> function are identical to the <tt>runPSM</tt> function, however there is one additional argument:</p>
<ul>
<li>
<tt>i</tt> - Index used to select a sample within <tt>boot</tt>
</li>
</ul>
<p>As the parameters are stored in the config object returned by runPSM it is possible to use <tt>do.call</tt> to simplify these calls assuming that models have already been fit using <tt>runPSM</tt>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">

<span class="co"># illustrative example using original analysis models</span>
<span class="co"># only create 2 replicates for illustration</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2358</span><span class="op">)</span>
<span class="va">boot_psm_PFS_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">boot</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">config</span>, R <span class="op">=</span> <span class="fl">2</span>, statistic <span class="op">=</span> <span class="va">bootPSM</span><span class="op">)</span><span class="op">)</span>

<span class="co"># is the same as</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2358</span><span class="op">)</span>
<span class="va">boot_psm_PFS_demo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.html">boot</a></span><span class="op">(</span>
  R <span class="op">=</span> <span class="fl">2</span>, <span class="co"># number of bootstrap samples</span>
  statistic <span class="op">=</span> <span class="va">bootPSM</span>, <span class="co"># bootstrap function</span>
  data<span class="op">=</span><span class="va">PFS_data</span>,
  time_var<span class="op">=</span><span class="st">"PFS_days"</span>,
  event_var<span class="op">=</span><span class="st">"PFS_event"</span>,
  model.type<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Common shape"</span>,
                <span class="st">"Independent shape"</span>, 
                <span class="st">"Separate"</span><span class="op">)</span>,
  distr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'exp'</span>,
            <span class="st">'weibull'</span>,
            <span class="st">'gompertz'</span>,
            <span class="st">'lnorm'</span>,
            <span class="st">'llogis'</span>,
            <span class="st">'gengamma'</span>,
            <span class="st">'gamma'</span>,
            <span class="st">'genf'</span><span class="op">)</span>,
  strata_var <span class="op">=</span> <span class="st">"ARMCD"</span>,
  int_name<span class="op">=</span><span class="st">"A"</span>,
  ref_name <span class="op">=</span> <span class="st">"B"</span>
<span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">boot_psm_PFS_all</span><span class="op">$</span><span class="va">t</span><span class="op">==</span><span class="va">boot_psm_PFS_demo</span><span class="op">$</span><span class="va">t</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></pre></div>
<p>For speed and to examine how this can be used we will repeat this selecting only 4 models.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2358</span><span class="op">)</span>
<span class="co"># To minimize vignette computation time only 100 bootstrap samples are taken. In general more samples should be used.</span>
<span class="va">n.sim</span> <span class="op">&lt;-</span> <span class="fl">100</span> 

<span class="va">psm_PFS_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPSM.html">runPSM</a></span><span class="op">(</span>
  data<span class="op">=</span><span class="va">PFS_data</span>,
  time_var<span class="op">=</span><span class="st">"PFS_days"</span>,
  event_var<span class="op">=</span><span class="st">"PFS_event"</span>,
  model.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Common shape"</span>, <span class="st">"Separate"</span><span class="op">)</span>,
  distr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'weibull'</span>, <span class="st">'gamma'</span><span class="op">)</span>,
  strata_var <span class="op">=</span> <span class="st">"ARMCD"</span>,
  int_name <span class="op">=</span> <span class="st">"B"</span>,
  ref_name <span class="op">=</span> <span class="st">"A"</span>
<span class="op">)</span>

<span class="va">PSM_bootstraps_PFS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">boot</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">psm_PFS_selected</span><span class="op">$</span><span class="va">config</span>,
                                             statistic <span class="op">=</span> <span class="va">bootPSM</span>, <span class="co"># bootstrap function</span>
                                             R<span class="op">=</span><span class="va">n.sim</span> <span class="co"># number of bootstrap samples</span>
                                             <span class="op">)</span>
                              <span class="op">)</span></pre></div>
<p>To use the result of these samples it is helpful to do some post processing to make the resulting samples easier to interpret.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="co"># first extract the bootstrapped parameters into a tibble</span>
<span class="va">PFS_bootsamples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">PSM_bootstraps_PFS</span><span class="op">$</span><span class="va">t</span><span class="op">)</span>
<span class="co">#&gt; Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.</span>
<span class="co">#&gt; Using compatibility `.name_repair`.</span>
<span class="co">#&gt; This warning is displayed once every 8 hours.</span>
<span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span>
<span class="co"># then add column names so can identify model and parameter more easily</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">PFS_bootsamples</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">PSM_bootstraps_PFS</span><span class="op">$</span><span class="va">t0</span><span class="op">)</span>

<span class="co"># show the first 3 samples</span>
<span class="va">PFS_bootsamples</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span>
<span class="co">#&gt; # A tibble: 3 × 18</span>
<span class="co">#&gt;   comshp.weibull.scale.int comshp.weibull.sca… comshp.weibull.… comshp.weibull.…</span>
<span class="co">#&gt;                      &lt;dbl&gt;               &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt; 1                     454.                230.             1.41             1.41</span>
<span class="co">#&gt; 2                     453.                252.             1.29             1.29</span>
<span class="co">#&gt; 3                     425.                224.             1.42             1.42</span>
<span class="co">#&gt; # … with 14 more variables: comshp.weibull.scale.TE &lt;dbl&gt;,</span>
<span class="co">#&gt; #   comshp.gamma.rate.int &lt;dbl&gt;, comshp.gamma.rate.ref &lt;dbl&gt;,</span>
<span class="co">#&gt; #   comshp.gamma.shape.int &lt;dbl&gt;, comshp.gamma.shape.ref &lt;dbl&gt;,</span>
<span class="co">#&gt; #   comshp.gamma.rate.TE &lt;dbl&gt;, sep.weibull.scale.int &lt;dbl&gt;,</span>
<span class="co">#&gt; #   sep.weibull.scale.ref &lt;dbl&gt;, sep.weibull.shape.int &lt;dbl&gt;,</span>
<span class="co">#&gt; #   sep.weibull.shape.ref &lt;dbl&gt;, sep.gamma.rate.int &lt;dbl&gt;,</span>
<span class="co">#&gt; #   sep.gamma.rate.ref &lt;dbl&gt;, sep.gamma.shape.int &lt;dbl&gt;, …</span></pre></div>
</div>
<div id="estimating-quantities-from-the-sample" class="section level1">
<h1 class="hasAnchor">
<a href="#estimating-quantities-from-the-sample" class="anchor"></a>Estimating quantities from the sample</h1>
<p>As the <tt>flexsurv</tt> parameterisations are used any quantity of interest can be simply calculated for all models and samples through use of the flexsurv functions such as the extrapolated means via flexsurv::mean_weibull. For this example we assume we have decided that separate models for reference and intervention are most appropriate and that for the reference arm a gamma model is preferred while for the intervention arm a weibull model is best.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="co"># we can now calculate the mean PFS for the selected models for each bootstrap sample</span>
<span class="co"># using weibull for the reference</span>
<span class="va">PFS_ref_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">PFS_bootsamples</span>, <span class="fu">flexsurv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flexsurv/man/means.html">mean_gamma</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">sep.gamma.shape.ref</span>, rate <span class="op">=</span> <span class="va">sep.gamma.rate.ref</span><span class="op">)</span><span class="op">)</span>
<span class="co"># using gamma for the intervention</span>
<span class="va">PFS_int_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">PFS_bootsamples</span>, <span class="fu">flexsurv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flexsurv/man/means.html">mean_weibull</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">sep.weibull.shape.int</span>, scale <span class="op">=</span> <span class="va">sep.weibull.scale.int</span><span class="op">)</span><span class="op">)</span>

<span class="co"># we could also calculate these values also for the original data for a deterministic estimate </span>
<span class="va">PFS_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summaryPSM.html">summaryPSM</a></span><span class="op">(</span><span class="va">psm_PFS_selected</span>,
                        type <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span> 

<span class="va">PFS_means</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="va">Model</span>, <span class="va">Dist</span>, <span class="va">Strata</span>,<span class="va">StrataName</span>, <span class="va">value</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">(</span><span class="va">Dist</span> <span class="op">==</span> <span class="st">"Gamma"</span> <span class="op">&amp;</span> <span class="va">Model</span> <span class="op">==</span> <span class="st">"Separate - Reference"</span><span class="op">)</span> <span class="op">|</span>
                  <span class="op">(</span><span class="va">Dist</span> <span class="op">==</span> <span class="st">"Weibull"</span> <span class="op">&amp;</span> <span class="va">Model</span> <span class="op">==</span> <span class="st">"Separate - Intervention"</span><span class="op">)</span> <span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 × 5</span>
<span class="co">#&gt;   Model                   Dist    Strata       StrataName value</span>
<span class="co">#&gt;   &lt;chr&gt;                   &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Separate - Intervention Weibull Intervention B           399.</span>
<span class="co">#&gt; 2 Separate - Reference    Gamma   Reference    A           207.</span>
                  

<span class="co"># we can then calculate the incremental mean PFS from these</span>
<span class="va">PFS_delta</span> <span class="op">=</span> <span class="va">PFS_int_mean</span> <span class="op">-</span> <span class="va">PFS_ref_mean</span> 


<span class="co"># if we are interested we can then estimate quantiles from this</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">PFS_delta</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>,<span class="fl">0.975</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;     2.5%    97.5% </span>
<span class="co">#&gt; 149.4424 236.3659</span>

<span class="co"># or plot the density of this derived quantity</span>

<span class="va">density</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">PFS_delta</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">density</span>, 
     lwd <span class="op">=</span> <span class="fl">2</span>, 
     main <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></pre></div>
<p><img src="Fitting_models_in_R_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
<div id="outputing-parameters-to-excel" class="section level1">
<h1 class="hasAnchor">
<a href="#outputing-parameters-to-excel" class="anchor"></a>Outputing parameters to excel</h1>
<p>The primary use of the bootstrap samples is to be used in probabilistic sensitivity analyses in economic models.</p>
<p>Once all the models have been fit and bootstrap samples estimated they can be output to excel. By selecting the “Main Estimates” the estimates for the original data are returned. To run PSA in excel only a random number between 1 and the number of samples needs to be generated and the associated Bootstrap sample selected.</p>
<div class="sourceCode" id="cb13"><pre class="downlit">

<span class="co"># combine the estimates from the main analysis with the bootstrap samples</span>
<span class="co"># and add meta data to include details of analysis</span>

<span class="co"># first we can get combine the main estimates for the models with those that were bootstrapped</span>
<span class="va">parameters_PFS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">PSM_bootstraps_PFS</span><span class="op">$</span><span class="va">t0</span>, <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">PSM_bootstraps_PFS</span><span class="op">$</span><span class="va">t</span><span class="op">)</span><span class="op">)</span>

<span class="co"># we can now add names</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">parameters_PFS</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">PSM_bootstraps_PFS</span><span class="op">$</span><span class="va">t0</span><span class="op">)</span>

<span class="co"># we can then label the samples and add some metadata</span>
<span class="va">metadata_PFS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Main Estimates"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Bootstrap Sample"</span>,<span class="fl">1</span><span class="op">:</span><span class="va">n.sim</span><span class="op">)</span><span class="op">)</span>,
                       Study_name <span class="op">=</span> <span class="st">"Study ABC"</span>,
                        Datacut <span class="op">=</span> <span class="st">"Final"</span>,
                        Population <span class="op">=</span> <span class="st">"ITT"</span>,
                        Endpoint <span class="op">=</span> <span class="st">"PFS"</span>,
                        RefArmName <span class="op">=</span> <span class="va">PSM_bootstraps_PFS</span><span class="op">$</span><span class="va">call</span><span class="op">$</span><span class="va">ref_name</span>,
                        IntArmName <span class="op">=</span> <span class="va">PSM_bootstraps_PFS</span><span class="op">$</span><span class="va">call</span><span class="op">$</span><span class="va">int_name</span><span class="op">)</span>

<span class="va">pfs_for_export</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">metadata_PFS</span>, <span class="va">parameters_PFS</span><span class="op">)</span>

<span class="co"># not run</span>
<span class="co">#write.csv(parameters_PFS, "params_for_model.csv")</span></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body">
<div id="ref-latimer2011nice" class="csl-entry">
<div class="csl-left-margin">[1] </div>
<div class="csl-right-inline">Latimer N. NICE DSU technical support document 14: Survival analysis for economic evaluations alongside clinical trials-extrapolation with patient-level data. Sheffield: Report by the Decision Support Unit 2011;2013.</div>
</div>
<div id="ref-rutherford2020nice" class="csl-entry">
<div class="csl-left-margin">[2] </div>
<div class="csl-right-inline">Rutherford MJ, Lambert PC, Sweeting MJ, Pennington B, Crowther MJ, Abrams KR, et al. NICE DSU TECHNICAL SUPPORT DOCUMENT 21: Flexible methods for survival analysis 2020.</div>
</div>
<div id="ref-cadth2020" class="csl-entry">
<div class="csl-left-margin">[3] </div>
<div class="csl-right-inline">CADTH. Procedures for CADTH drug reimbursement reviews 2020.</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Iain Bennett, Jo Gregory, Sarah Smith, Richard Birnie.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
