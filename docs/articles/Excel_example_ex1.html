<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Excel example 1 - extrapolation calculations â€¢ flexsurvPlus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Excel example 1 - extrapolation calculations">
<meta property="og:description" content="flexsurvPlus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flexsurvPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.06</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://roche.github.io/Global-HTA-Evidence-Open/index.html">Global-HTA-Evidence-Open</a>
    </li>
    <li>
      <a href="https://roche.github.io/flexsurvPlus/index.html">flexsurvPlus</a>
    </li>
    <li>
      <a href="https://roche.github.io/gemtcPlus/index.html">gemtcPlus</a>
    </li>
    <li>
      <a href="https://roche.github.io/MAIC/index.html">MAIC</a>
    </li>
    <li>
      <a href="https://roche.github.io/rpsftmPlus/index.html">rpsftmPlus</a>
    </li>
    <li>
      <a href="https://roche.github.io/descem/index.html">descem</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Roche/flexsurvPlus">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Excel_example_ex1_files/header-attrs-2.14/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Excel example 1 - extrapolation calculations</h1>
                        <h4 class="author">Roche</h4>
            
            <h4 class="date">2022-06-08</h4>
      
      
      <div class="hidden name"><code>Excel_example_ex1.Rmd</code></div>

    </div>

    
    
<style type="text/css">
  
  body{ /* Normal  */
      font-size: 14px;
  }
td {  /* Table  */
    font-size: 10px;
}
h1.title {
  font-size: 38px;
}
h1 { /* Header 1 */
    font-size: 28px;
}
h2 { /* Header 2 */
    font-size: 22px;
}
h3 { /* Header 3 */
    font-size: 18px;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette describes how to work with the included example excel templates that are compatible to the survival models estimated with flexsurvPlus. These examples are deliberately simple and are intended to illustrate calculations in excel rather than as a basis for a real economic model. In this example the basic calculations needed to extrapolate survival are illustrated.</p>
</div>
<div id="set-up-packages-and-data" class="section level1">
<h1 class="hasAnchor">
<a href="#set-up-packages-and-data" class="anchor"></a>Set up packages and data</h1>
<div id="install-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#install-packages" class="anchor"></a>Install packages</h2>
<p>The following packages are required to run this example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Libraries</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">flexsurvPlus</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></pre></div>
</div>
<div id="generate-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-the-data" class="anchor"></a>Generate the data</h2>
<p>To perform survival analyses, patient level data is required for the survival endpoints. In this example, we analyze progression-free survival (PFS). For more details on these steps please refer to the other vignettes.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">

<span class="co"># make reproducible</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>

<span class="co"># used later </span>
<span class="op">(</span><span class="va">simulation_seed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span>, min<span class="op">=</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 11370342</span>
<span class="op">(</span><span class="va">bootstrap_seed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span>, min<span class="op">=</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 62229940</span>

<span class="co"># low number for speed of execution given illustrating concept</span>
<span class="va">n_bootstrap</span> <span class="op">&lt;-</span> <span class="fl">10</span>

<span class="va">adtte</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_adtte.html">sim_adtte</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="va">simulation_seed</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">adtte</span><span class="op">)</span>
<span class="co">#&gt;   USUBJID ARMCD             ARM PARAMCD                     PARAM AVAL AVALU</span>
<span class="co">#&gt; 1       1     A Reference Arm A     PFS Progression Free Survival  108  DAYS</span>
<span class="co">#&gt; 2       2     A Reference Arm A     PFS Progression Free Survival  150  DAYS</span>
<span class="co">#&gt; 3       3     A Reference Arm A     PFS Progression Free Survival  372  DAYS</span>
<span class="co">#&gt; 4       4     A Reference Arm A     PFS Progression Free Survival   73  DAYS</span>
<span class="co">#&gt; 5       5     A Reference Arm A     PFS Progression Free Survival  137  DAYS</span>
<span class="co">#&gt; 6       6     A Reference Arm A     PFS Progression Free Survival  103  DAYS</span>
<span class="co">#&gt;   CNSR</span>
<span class="co">#&gt; 1    0</span>
<span class="co">#&gt; 2    0</span>
<span class="co">#&gt; 3    0</span>
<span class="co">#&gt; 4    0</span>
<span class="co">#&gt; 5    0</span>
<span class="co">#&gt; 6    0</span>

<span class="co"># subset PFS data and rename</span>
<span class="va">PFS_data</span> <span class="op">&lt;-</span> <span class="va">adtte</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">PARAMCD</span><span class="op">==</span><span class="st">"PFS"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="va">USUBJID</span>,
            <span class="va">ARMCD</span>,
            PFS_days <span class="op">=</span> <span class="va">AVAL</span>,
            PFS_event <span class="op">=</span> <span class="fl">1</span><span class="op">-</span> <span class="va">CNSR</span>
  <span class="op">)</span></pre></div>
</div>
</div>
<div id="fitting-the-models" class="section level1">
<h1 class="hasAnchor">
<a href="#fitting-the-models" class="anchor"></a>Fitting the models</h1>
<p>More information about each function can be used by running the code <tt>?runPSM</tt> or viewing the other vignettes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">psm_PFS_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPSM.html">runPSM</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">PFS_data</span>,
                     time_var<span class="op">=</span><span class="st">"PFS_days"</span>,
                     event_var<span class="op">=</span><span class="st">"PFS_event"</span>,
                     model.type<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Common shape"</span>, 
                                   <span class="st">"Independent shape"</span>, 
                                   <span class="st">"Separate"</span><span class="op">)</span>,
                     distr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'exp'</span>,
                               <span class="st">'weibull'</span>,
                               <span class="st">'gompertz'</span>,
                               <span class="st">'lnorm'</span>,
                               <span class="st">'llogis'</span>,
                               <span class="st">'gengamma'</span>,
                               <span class="st">'gamma'</span>,
                               <span class="st">'genf'</span><span class="op">)</span>,
                     strata_var <span class="op">=</span> <span class="st">"ARMCD"</span>,
                     int_name <span class="op">=</span> <span class="st">"B"</span>,
                     ref_name <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></pre></div>
</div>
<div id="bootstrap-the-estimated-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#bootstrap-the-estimated-parameters" class="anchor"></a>Bootstrap the estimated parameters</h1>
<p>As described in other vignettes we can use <code>boot</code> to explore uncertainty.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co"># fix seed for reproducible samples</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">bootstrap_seed</span><span class="op">)</span>

<span class="va">boot_psm_PFS_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">boot</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">config</span>, statistic <span class="op">=</span> <span class="va">bootPSM</span>, R <span class="op">=</span> <span class="va">n_bootstrap</span><span class="op">)</span><span class="op">)</span></pre></div>
</div>
<div id="exporting-to-excel" class="section level1">
<h1 class="hasAnchor">
<a href="#exporting-to-excel" class="anchor"></a>Exporting to Excel</h1>
<p>Once the values are calculated we can export to Excel. The following code prepares two tibbles that can be exported. One containing the main estimates. A second containing the bootstrap samples.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">

<span class="va">main_estimates</span> <span class="op">&lt;-</span> <span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">parameters_vector</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>


<span class="va">boot_estimates</span> <span class="op">&lt;-</span> <span class="va">boot_psm_PFS_all</span><span class="op">$</span><span class="va">t</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> 

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">main_estimates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">boot_estimates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">psm_PFS_all</span><span class="op">$</span><span class="va">parameters_vector</span><span class="op">)</span>

<span class="co"># can preview these tables</span>
  
<span class="va">main_estimates</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">%&gt;%</span>
  <span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pandoc.table.return.html">pandoc.table</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ----------------------------------------------------------------</span>
<span class="co">#&gt;  comshp.exp.rate.int   comshp.exp.rate.ref   comshp.exp.rate.TE </span>
<span class="co">#&gt; --------------------- --------------------- --------------------</span>
<span class="co">#&gt;       0.002711              0.005584              -0.7226       </span>
<span class="co">#&gt; ----------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Table: Table continues below</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; -----------------------------------------------------</span>
<span class="co">#&gt;  comshp.weibull.scale.int   comshp.weibull.scale.ref </span>
<span class="co">#&gt; -------------------------- --------------------------</span>
<span class="co">#&gt;           370.9                      193.4           </span>
<span class="co">#&gt; -----------------------------------------------------</span>

<span class="va">boot_estimates</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">%&gt;%</span>
  <span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pandoc.table.return.html">pandoc.table</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ----------------------------------------------------------------</span>
<span class="co">#&gt;  comshp.exp.rate.int   comshp.exp.rate.ref   comshp.exp.rate.TE </span>
<span class="co">#&gt; --------------------- --------------------- --------------------</span>
<span class="co">#&gt;       0.002409              0.006054              -0.9214       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       0.002592              0.005716              -0.7907       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       0.002603              0.005959              -0.8283       </span>
<span class="co">#&gt; ----------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Table: Table continues below</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; -----------------------------------------------------</span>
<span class="co">#&gt;  comshp.weibull.scale.int   comshp.weibull.scale.ref </span>
<span class="co">#&gt; -------------------------- --------------------------</span>
<span class="co">#&gt;           410.9                       177            </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           383.7                      188.9           </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           384.4                      183.9           </span>
<span class="co">#&gt; -----------------------------------------------------</span>

<span class="co"># the following code is not run in the vignette but will export this file </span>

<span class="co"># require(openxlsx)</span>
<span class="co"># wb &lt;- openxlsx::createWorkbook()</span>
<span class="co"># openxlsx::addWorksheet(wb, sheetName = "Exported data") </span>
<span class="co"># openxlsx::writeDataTable(wb, sheet = "Exported data", main_estimates, startRow = 2, startCol = 2)</span>
<span class="co"># openxlsx::writeDataTable(wb, sheet = "Exported data", boot_estimates, startRow = 5, startCol = 2)</span>
<span class="co"># openxlsx::createNamedRegion(wb, sheet = "Exported data", </span>
<span class="co">#                             cols = 2:(2+length(main_estimates)), rows = 3, name = "Estimates")</span>
<span class="co"># openxlsx::createNamedRegion(wb, sheet = "Exported data", </span>
<span class="co">#                             cols = 2:(2+length(main_estimates)), rows = 6:(6-1+nrow(boot_estimates)), name = "Samples")</span>
<span class="co"># openxlsx::saveWorkbook(wb, file = "export_data.xlsx", overwrite = TRUE)</span></pre></div>
</div>
<div id="the-excel-model" class="section level1">
<h1 class="hasAnchor">
<a href="#the-excel-model" class="anchor"></a>The Excel model</h1>
<p>Included with the package is an example Excel file called <code>ex1_calculation.xlsx</code>. This can be extracted using the below code (not run). It can also be found in the github repository at <a href="https://github.com/Roche/flexsurvPlus/tree/main/inst/extdata" class="uri">https://github.com/Roche/flexsurvPlus/tree/main/inst/extdata</a></p>
<div class="sourceCode" id="cb6"><pre class="downlit">

<span class="va">installed_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/ex1_calculation.xlsx"</span>, package <span class="op">=</span> <span class="st">"flexsurvPlus"</span><span class="op">)</span> 
<span class="va">installed_file</span>
<span class="co">#&gt; [1] "/tmp/RtmpaqRSRW/temp_libpath1ea12e4611ac/flexsurvPlus/extdata/ex1_calculation.xlsx"</span>

<span class="co"># not run but will give you a local copy of the file</span>
<span class="co"># file.copy(from = installed_file, to ="copy_of_ex1_calculation.xlsx")</span></pre></div>
<p>This illustrates how all the included survival models can be extrapolated in Excel.</p>
<div id="exported-data-tab" class="section level2">
<h2 class="hasAnchor">
<a href="#exported-data-tab" class="anchor"></a>Exported data tab</h2>
<p>This contains a copy of the data exported in the last step.</p>
<div class="figure">
<img src="excel_ex1_img1.png" alt=""><p class="caption">Exported data tab</p>
</div>
</div>
<div id="extrapolations-tab" class="section level2">
<h2 class="hasAnchor">
<a href="#extrapolations-tab" class="anchor"></a>Extrapolations tab</h2>
<p>This contains example calculations to extrapolate survival.</p>
<div class="figure">
<img src="excel_ex1_img2.png" alt=""><p class="caption">Extrapolations tab</p>
</div>
<p>We can compare the approximate estimates of mean survival with those calculated in R. As the excel model only goes until time t=2000 we can more directly compare to the estimates of restricted mean survival time (rmst) until this time.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">

<span class="va">means_est</span> <span class="op">&lt;-</span> <span class="va">psm_PFS_all</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/summaryPSM.html">summaryPSM</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mean"</span>,<span class="st">"rmst"</span><span class="op">)</span>, t <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span> 

<span class="co"># match to selected model in screenshot</span>
<span class="va">means_est</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Model</span> <span class="op">==</span> <span class="st">"Common shape"</span>, <span class="va">Strata</span><span class="op">==</span><span class="st">"Intervention"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dist"</span><span class="op">)</span>,
                          names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"type"</span><span class="op">)</span>,
                          values_from <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pandoc.table.return.html">pandoc.table</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -----------------------------------</span>
<span class="co">#&gt;        Dist          mean    rmst  </span>
<span class="co">#&gt; ------------------- ------- -------</span>
<span class="co">#&gt;     Exponential      368.9   367.3 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Weibull         339     339  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      Gompertz        326.3   326.3 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Log Normal       414.2   395.6 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    Log Logistic      459.4   405.7 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Generalized Gamma   338.8   338.8 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        Gamma         346.8   346.8 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    Generalized F     342.6   342.5 </span>
<span class="co">#&gt; -----------------------------------</span></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Iain Bennett, Jo Gregory, Sarah Smith, Richard Birnie.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
