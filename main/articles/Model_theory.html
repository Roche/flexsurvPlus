<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parametric survival analysis using the flexsurvPlus package: understanding the theory • flexsurvPlus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Parametric survival analysis using the flexsurvPlus package: understanding the theory">
<meta property="og:description" content="flexsurvPlus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-SGZFXJEC6X"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SGZFXJEC6X');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flexsurvPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.06</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://roche.github.io/Global-HTA-Evidence-Open/index.html" class="external-link">Global-HTA-Evidence-Open</a>
    </li>
    <li>
      <a href="https://roche.github.io/flexsurvPlus/index.html" class="external-link">flexsurvPlus</a>
    </li>
    <li>
      <a href="https://roche.github.io/gemtcPlus/index.html" class="external-link">gemtcPlus</a>
    </li>
    <li>
      <a href="https://roche.github.io/MAIC/index.html" class="external-link">MAIC</a>
    </li>
    <li>
      <a href="https://roche.github.io/rpsftmPlus/index.html" class="external-link">rpsftmPlus</a>
    </li>
    <li>
      <a href="https://roche.github.io/descem/index.html" class="external-link">descem</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Roche/flexsurvPlus" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Parametric survival analysis using the
flexsurvPlus package: understanding the theory</h1>
                        <h4 data-toc-skip class="author">Roche</h4>
            
            <h4 data-toc-skip class="date">2023-05-02</h4>
      
      
      <div class="hidden name"><code>Model_theory.Rmd</code></div>

    </div>

    
    
<style type="text/css">

body{ /* Normal  */
      font-size: 14px;
  }
td {  /* Table  */
  font-size: 12px;
}
h1.title {
  font-size: 38px;
}
h1 { /* Header 1 */
  font-size: 28px;
  }
h2 { /* Header 2 */
    font-size: 22px;
}
h3 { /* Header 3 */
  font-size: 18px;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Parametric survival models are often the preferred method of
extrapolating survival data for use in economic models. The National
Institute for Health and Care Excellence (NICE) Decision Support Unit
(DSU) technical support document (TSD) 14 recommends that the
Exponential, Weibull, Gompertz, log-logistic, log normal and Generalized
Gamma parametric models should all be considered.<span class="citation">[1]</span> More recently, NICE also discusses more
flexible models in NICE DSU TSD 21, however, more these models are not
in the scope of this package.<span class="citation">[2]</span> The
Canadian Agency for Drugs and Technologies in Health (CADTH)
additionally specifies that the Gamma distribution must also be
considered. This document therefore details the characteristics of each
of these distributions and demonstrates how the parameters from each
distribution, outputted using the flexsurvPlus package, can be
implemented within an economic model.<span class="citation">[3]</span>
The Generalized F distribution is not commonly used, however it has been
included in this package in case more flexible modeling is required.</p>
<p>The flexsurvPlus package allows the inclusion of a treatment effect
in the following three ways:</p>
<ul>
<li>
<p>Separate models - Models fitted to each treatment arm
separately</p>
<ul>
<li>Similarly, a separate model can be fitted to data from a single
treatment arm</li>
</ul>
</li>
<li><p>Independent shape models - Models fitted to both/all treatment
arms including a treatment covariate to model the effect of treatment on
both the scale and shape parameter(s) of the distribution.</p></li>
<li><p>Common shape models - Models fitted to both/all treatment arms
including a treatment covariate to model the effect of treatment on the
scale parameter of the distribution. The shape parameter(s) of the
distribution is common across treatments which reflects an assumption of
proportional hazards or accelerated failure time between treatments
depending on the distribution</p></li>
</ul>
<p>This document details the parameters for each of these three model
types. A separate vignette; “Fitting parametric survival models in R”
details how to perform the analyses in R using the <tt>flexsurvPlus</tt>
package.</p>
</div>
<div class="section level2">
<h2 id="properties-of-the-distributions">Properties of the distributions<a class="anchor" aria-label="anchor" href="#properties-of-the-distributions"></a>
</h2>
<p>The properties of each parametric distribution are summarized in the
Table below.</p>
<p>By default, covariates are placed on the “location” parameter of the
distribution, typically the “scale” or “rate” parameter, through a
linear model, or a log-linear model if this parameter must be positive.
This gives an accelerated failure time model or a proportional hazards
model (see Table below) depending on how the distribution is
parametrized.The other parameters are ancillary parameters that
determine the shape, variance, or higher moments of the distribution.
These parameters impact the hazard function, which can take a variety of
shapes depending on the distribution:<span class="citation">[4,5]</span></p>
<ul>
<li>the exponential distribution only supports a constant hazard;</li>
<li>the Weibull, Gompertz, and gamma distributions support monotonically
increasing and decreasing hazards;</li>
<li>the log-logistic and log-normal distributions support arc-shaped and
monotonically decreasing hazards;</li>
<li>and the generalized gamma distribution supports an arc-shaped,
bathtub-shaped, monotonically increasing, and monotonically decreasing
hazards.</li>
</ul>
<p>The log-hazard function of the Weibull model is linear with respect
to the log of time. The log-hazard function of the Gompertz model is
linear with respect to time.</p>
<div class="section level3">
<h3 id="special-cases">Special cases<a class="anchor" aria-label="anchor" href="#special-cases"></a>
</h3>
<ul>
<li>The Weibull distribution reduces to an exponential distribution when
the Weibull shape parameter equals 1 (<span class="math inline">\(a=1\)</span>) and the exponential rate parameter
is 1 divided by the the Weibull scale parameter (<span class="math inline">\(\frac{1}{b}\)</span>).</li>
<li>The Gompertz distribution reduces to an exponential distribution
when the Gompertz shape parameter equals 0 (<span class="math inline">\(a=0\)</span>).</li>
<li>The Generalized Gamma distribution reduces to an exponential model
(<span class="math inline">\(Q=\sigma=1\)</span>), Weibull model (<span class="math inline">\(Q=1\)</span>), gamma model (<span class="math inline">\(Q=\sigma\)</span>) and log-normal model (<span class="math inline">\(Q=0\)</span>).</li>
<li>The Generalized F distribution reduces to the Generalized Gamma
distribution (<span class="math inline">\(P=1\)</span>)</li>
</ul>
</div>
<div class="section level3">
<h3 id="initial-diagnostics">Initial diagnostics<a class="anchor" aria-label="anchor" href="#initial-diagnostics"></a>
</h3>
<p>Before fitting any models, the following initial diagnostic plots are
helpful to understand which distribution might be the best fit to the
data being modeled:</p>
<ul>
<li>Kaplan–Meier plot
<ul>
<li>To display the survival function for each treatment</li>
</ul>
</li>
<li>Log-cumulative hazard plot
<ul>
<li>Visual inspection of a log-cumulative hazard plot allows assessment
of the proportional hazards assumption. In addition, they provide an
alternative way to assess changes in hazards over time.</li>
</ul>
</li>
<li>Smoothed hazard plot
<ul>
<li>Does the shape of the hazard plot indicate that a certain
distribution is more appropriate than another? Possible shapes of the
hazard function for each of the distributions that can be fitted with
the flexsurvPlus package are described in Table X below. For example, if
the hazard is constant, an exponential distribution might be the most
appropriate fit to the data.</li>
</ul>
</li>
</ul>
<table class="table">
<caption>
Properties of common parametric survival distributions
</caption>
<thead><tr>
<th style="text-align:left;">
Distribution
</th>
<th style="text-align:left;">
Number of parameters
</th>
<th style="text-align:left;">
Location parameter
</th>
<th style="text-align:left;">
Ancillary parameter
</th>
<th style="text-align:left;">
Survival function: S(t)
</th>
<th style="text-align:left;">
Hazard function: h(t)
</th>
<th style="text-align:left;">
Possible shapes of the hazard function
</th>
<th style="text-align:left;">
Treatment effect model assumption
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Exponential
</td>
<td style="text-align:left;">
<span class="math inline">\(1: \ b\)</span>
</td>
<td style="text-align:left;">
rate (b)
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<span class="math inline">\(e^{-b t}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(b\)</span>
</td>
<td style="text-align:left;">
Constant
</td>
<td style="text-align:left;">
PH and AFT
</td>
</tr>
<tr>
<td style="text-align:left;">
Weibull
</td>
<td style="text-align:left;">
<span class="math inline">\(2:\ a, b\)</span>
</td>
<td style="text-align:left;">
scale (b)
</td>
<td style="text-align:left;">
shape (a)
</td>
<td style="text-align:left;">
<span class="math inline">\(e^{(\frac{-t}{b})^{a}}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(a\frac{t}{b}^{a -1}\)</span>
</td>
<td style="text-align:left;">
Constant, monotonically increasing, monotonically decreasing
</td>
<td style="text-align:left;">
AFT
</td>
</tr>
<tr>
<td style="text-align:left;">
Gompertz
</td>
<td style="text-align:left;">
<span class="math inline">\(2:\ a, b\)</span>
</td>
<td style="text-align:left;">
rate (b)
</td>
<td style="text-align:left;">
shape (a)
</td>
<td style="text-align:left;">
<span class="math inline">\(e^{\frac{-b}{a} (e^{a t}-1)}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(b e^{a t}\)</span>
</td>
<td style="text-align:left;">
Constant, monotonically increasing, monotonically decreasing
</td>
<td style="text-align:left;">
PH
</td>
</tr>
<tr>
<td style="text-align:left;">
Log-logistic
</td>
<td style="text-align:left;">
<span class="math inline">\(2:\ a, b\)</span>
</td>
<td style="text-align:left;">
scale (b)
</td>
<td style="text-align:left;">
shape (a)
</td>
<td style="text-align:left;">
<span class="math inline">\(\frac{1}{1 + (\frac{t}{b})^a}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\frac{\frac{a}{b}(\frac{t}{b})^{a - 1}}{1 +
(\frac{t}{b})^a}\)</span>
</td>
<td style="text-align:left;">
Monotonically decreasing, initial increase the decrease
</td>
<td style="text-align:left;">
AFT
</td>
</tr>
<tr>
<td style="text-align:left;">
Log-normal
</td>
<td style="text-align:left;">
<span class="math inline">\(2: \ \mu, \sigma\)</span>
</td>
<td style="text-align:left;">
meanlog (<span class="math inline">\(\mu\)</span>)
</td>
<td style="text-align:left;">
sdlog (<span class="math inline">\(\sigma\)</span>)
</td>
<td style="text-align:left;">
<span class="math inline">\(1 - \Phi \frac{log t - \mu}{\sigma}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\frac{\frac{1}{\sigma \sqrt{2
\pi}}t^{-1}e[-\frac{(log t - \mu)^2}{2 \sigma^2}]}{S(t)}\)</span>
</td>
<td style="text-align:left;">
Initially increases then decreases
</td>
<td style="text-align:left;">
AFT
</td>
</tr>
<tr>
<td style="text-align:left;">
Gamma
</td>
<td style="text-align:left;">
<span class="math inline">\(2: \ a, b\)</span>
</td>
<td style="text-align:left;">
rate (b)
</td>
<td style="text-align:left;">
shape (a)
</td>
<td style="text-align:left;">
<span class="math inline">\(1 - \frac{\gamma(a, bt)}{\Gamma(a)}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\frac{b^at^{a -1}e^{-bt}}{\Gamma(a)
S(t)}\)</span>
</td>
<td style="text-align:left;">
Constant, monotonically increasing, monotonically decreasing
</td>
<td style="text-align:left;">
AFT
</td>
</tr>
<tr>
<td style="text-align:left;">
Generalized gamma
</td>
<td style="text-align:left;">
<span class="math inline">\(3: \ \mu, \sigma, Q\)</span>
</td>
<td style="text-align:left;">
mu (<span class="math inline">\(\mu\)</span>)
</td>
<td style="text-align:left;">
sigma (<span class="math inline">\(\sigma\)</span>), Q
</td>
<td style="text-align:left;">
<span class="math inline">\(1 - \frac{\gamma(Q^{-2}, Q^{-2}e^{Q
\frac{log(t) – \mu}{\sigma}})}{\Gamma(Q^{-2})}; \  if \ Q \neq
0\)</span>  <span class="math inline">\(1 - \Phi(\frac{logt –
\mu}{\sigma}); \ if \ Q = 0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\frac{|Q|(Q^{-2})^{Q^{-2}}}{\sigma t
\Gamma(Q^{-2}) S(t)} \exp\left[Q^{-2}\left(Q\frac{logt –
\mu}{\sigma}-e^{Q\frac{logt – \mu}{\sigma}}\right)\right]\)</span>
</td>
<td style="text-align:left;">
Constant, monotonically increasing, monotonically decreasing, bathtub,
arc-shaped
</td>
<td style="text-align:left;">
AFT
</td>
</tr>
<tr>
<td style="text-align:left;">
Generalized F
</td>
<td style="text-align:left;">
<span class="math inline">\(4: \ \mu, \sigma, Q, P\)</span>
</td>
<td style="text-align:left;">
mu (<span class="math inline">\(\mu\)</span>)
</td>
<td style="text-align:left;">
sigma (<span class="math inline">\(\sigma\)</span>), Q, P
</td>
<td style="text-align:left;">
<span class="math display">\[ \int_{0}^{s_{1}(s_{2}+s_{1}e^{w})^{-1}}
\frac{x^{s_{2}-1}(1-x)^{s_{1}-1}}{B(s_{2}, s_{1})} \ dx \]</span>
</td>
<td style="text-align:left;">
<span class="math display">\[ \frac{\delta
(s_{1}/s_{2})^{s_{1}}e^{s_{1}w}}{\sigma x (1 + s_{1}
e^{w}/s_{2})^{(s_{1} + s_{2})}B(s_{1}, s_{2})S(t)}\]</span>
</td>
<td style="text-align:left;">
Decreasing, arc-shaped
</td>
<td style="text-align:left;">
AFT
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="exponential">Exponential<a class="anchor" aria-label="anchor" href="#exponential"></a>
</h2>
<div class="section level3">
<h3 id="separate-models">Separate models<a class="anchor" aria-label="anchor" href="#separate-models"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Separate”</li>
<li>distr = “exp”</li>
</ul>
<p>uses the flexsurv package to fit two exponential models (one to data
for the intervention treatment and one to data for the reference
treatment). The R code for the fitted models is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code>
<em>data for intervention treatment </em><code>, dist = "exp")</code>
<code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code> <em>data
for reference treatment </em><code>, dist = "exp")</code></p>
<p>The estimated rate parameter from each of these models can be then
used within the following Excel formula to estimate survival at
different time points:</p>
<p><code>EXP(-rate*time)</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg exponential model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="common-shape-models">Common shape models<a class="anchor" aria-label="anchor" href="#common-shape-models"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Common shape”</li>
<li>distr = “exp”</li>
</ul>
<p>uses the flexsurv package to fit one exponential model with a
covariate for treatment. The R code for the fitted model is as
follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~ARM, data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "exp")</code></p>
<p>This model outputs a rate parameter and treatment coefficient. Rate
parameters for each treatment are estimated in <em>run_PSM</em> as
follows:</p>
<table class="table">
<caption>
Rate parameter for intervention and reference treatments from a common
shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Rate (intervention treatment)
</th>
<th style="text-align:left;">
Rate (reference treatment)
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
Rate parameter + treatment coefficient
</td>
<td style="text-align:left;">
Rate parameter
</td>
</tr></tbody>
</table>
<p>Survival can then be estimated in Excel using these two rate
parameters, as for the separate models, with formula:</p>
<p><code>EXP(-rate*time)</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg exponential model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
</div>
<div class="section level2">
<h2 id="weibull">Weibull<a class="anchor" aria-label="anchor" href="#weibull"></a>
</h2>
<p>The Weibull model may be parametrized as either a proportional
hazards model or as an accelerated failure time model; however, the
<em>flexsurv</em> package parametrizes the Weibull as an accelerated
failure time model.</p>
<div class="section level3">
<h3 id="separate-models-1">Separate models<a class="anchor" aria-label="anchor" href="#separate-models-1"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Separate”</li>
<li>distr = “weibull”</li>
</ul>
<p>uses the flexsurv package to fit two weibull models (one to data for
the intervention treatment and one to data for the reference treatment).
The R code for the fitted models is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code>
<em>data for intervention treatment
</em><code>, dist = "weibull")</code>
<code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code> <em>data
for reference treatment </em><code>, dist = "weibull")</code></p>
<p>Estimated shape and scale parameters from each of these models can be
then used within the following Excel formula to estimate survival at
different time points:</p>
<p><code>1-WEIBULL(time,shape,scale,TRUE)</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg weibull model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="common-shape-models-1">Common shape models<a class="anchor" aria-label="anchor" href="#common-shape-models-1"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Common shape”</li>
<li>distr = “weibull”</li>
</ul>
<p>uses the flexsurv package to fit one weibull model with a covariate
for treatment. The R code for the fitted model is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~ARM, data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "weibull")</code></p>
<p>This model outputs shape and scale parameters and a treatment
coefficient on the scale parameter. Shape and scale parameters for each
treatment are estimated in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Shape and scale parameters for intervention and reference treatments
from a common shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Shape
</td>
<td style="text-align:left;">
Shape parameter
</td>
<td style="text-align:left;">
Shape parameter
</td>
</tr>
<tr>
<td style="text-align:left;">
Scale
</td>
<td style="text-align:left;">
Scale parameter + treatment coefficient
</td>
<td style="text-align:left;">
Scale parameter
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the shape and scale
parameters specific to each treatment with formula:</p>
<p><code>1-WEIBULL(time,shape,scale,TRUE)</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg weibull model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="independent-shape-models">Independent shape models<a class="anchor" aria-label="anchor" href="#independent-shape-models"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Independent shape”</li>
<li>distr = “weibull”</li>
</ul>
<p>uses the flexsurv package to fit one weibull model with a covariate
for treatment on both the scale and shape parameters. The R code for the
fitted model is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event) ~ ARM + shape(ARM), data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "weibull")</code></p>
<p>This model outputs shape and scale parameters and a treatment
coefficient for both shape and scale. Shape and scale parameters for
each treatment are estimated in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Shape and scale parameters for intervention and reference treatments
from an independent shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Shape
</td>
<td style="text-align:left;">
Shape parameter + treatment coefficient for shape
</td>
<td style="text-align:left;">
Shape parameter
</td>
</tr>
<tr>
<td style="text-align:left;">
Scale
</td>
<td style="text-align:left;">
Scale parameter + treatment coefficient for scale
</td>
<td style="text-align:left;">
Scale parameter
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the shape and scale
parameters specific to each treatment with formula:</p>
<p><code>1-WEIBULL(time,shape,scale,TRUE)</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg weibull model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
</div>
<div class="section level2">
<h2 id="gompertz">Gompertz<a class="anchor" aria-label="anchor" href="#gompertz"></a>
</h2>
<div class="section level3">
<h3 id="separate-models-2">Separate models<a class="anchor" aria-label="anchor" href="#separate-models-2"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Separate”</li>
<li>distr = “gompertz”</li>
</ul>
<p>uses the flexsurv package to fit two gompertz models (one to data for
the intervention treatment and one to data for the reference treatment).
The R code for the fitted models is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code>
<em>data for intervention treatment
</em><code>, dist = "gompertz")</code>
<code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code> <em>data
for reference treatment </em><code>, dist = "gompertz")</code></p>
<p>Estimation of the rate and shape parameters from each of these models
can be then used within the following Excel formula to estimate survival
at different time points:</p>
<p><code>EXP((-1/shape) * rate * (EXP(shape*time)-1))</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg gompertz model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="common-shape-models-2">Common shape models<a class="anchor" aria-label="anchor" href="#common-shape-models-2"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Common shape”</li>
<li>distr = “gompertz”</li>
</ul>
<p>uses the flexsurv package to fit one gompertz model with a covariate
for treatment on the rate parameter. The R code for the fitted model is
as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~ARM, data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "gompertz")</code></p>
<p>This model outputs rate and shape parameters and a treatment
coefficient. Rate and shape parameters for each treatment are estimated
in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Rate and shape parameters for intervention and reference treatments from
a common shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Rate
</td>
<td style="text-align:left;">
Rate parameter + treatment coefficient
</td>
<td style="text-align:left;">
Rate parameter
</td>
</tr>
<tr>
<td style="text-align:left;">
Shape
</td>
<td style="text-align:left;">
Shape parameter
</td>
<td style="text-align:left;">
Shape parameter
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the rate and shape
parameters specific to each treatment with formula:</p>
<p><code>EXP((-1/shape) * rate * (EXP(shape*time)-1))</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg gompertz model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="independent-shape-models-1">Independent shape models<a class="anchor" aria-label="anchor" href="#independent-shape-models-1"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Independent shape”</li>
<li>distr = “gompertz”</li>
</ul>
<p>uses the flexsurv package to fit one gompertz model with a covariate
for treatment on both the rate and shape parameters. The R code for the
fitted model is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event) ~ ARM + shape(ARM), data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "gompertz")</code></p>
<p>This model outputs rate and shape parameters and a treatment
coefficient for both rate and shape. Rate and shape parameters for each
treatment are estimated in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Rate and shape parameters for intervention and reference treatments from
an independent shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Rate
</td>
<td style="text-align:left;">
Rate parameter + treatment coefficient on rate
</td>
<td style="text-align:left;">
Rate parameter
</td>
</tr>
<tr>
<td style="text-align:left;">
Shape
</td>
<td style="text-align:left;">
Shape parameter + treatment coeffecient on shape
</td>
<td style="text-align:left;">
Shape parameter
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the rate and shape
parameters specific to each treatment with formula:</p>
<p><code>EXP((-1/shape) * rate * (EXP(shape*time)-1))</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg gompertz model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
</div>
<div class="section level2">
<h2 id="log-logistic">Log-logistic<a class="anchor" aria-label="anchor" href="#log-logistic"></a>
</h2>
<div class="section level3">
<h3 id="separate-models-3">Separate models<a class="anchor" aria-label="anchor" href="#separate-models-3"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Separate”</li>
<li>distr = “llogis”</li>
</ul>
<p>uses the flexsurv package to fit two log-logistic models (one to data
for the intervention treatment and one to data for the reference
treatment). The R code for the fitted models is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code>
<em>data for intervention treatment </em><code>, dist = "llogis")</code>
<code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code> <em>data
for reference treatment </em><code>, dist = "llogis")</code></p>
<p>Estimation of the shape and scale parameters from each of these
models can be then used within the following Excel formula to estimate
survival at different time points:</p>
<p><code>1 /(1+((time / scale)^shape))</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg log-logistic model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="common-shape-models-3">Common shape models<a class="anchor" aria-label="anchor" href="#common-shape-models-3"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Common shape”</li>
<li>distr = “llogis”</li>
</ul>
<p>uses the flexsurv package to fit one log-logistic model with a
covariate for treatment. The R code for the fitted model is as
follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~ARM, data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "llogis")</code></p>
<p>This model outputs shape and scale parameters and a treatment
coefficient. Shape and scale parameters for each treatment are estimated
in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Shape and scale parameters for intervention and reference treatments
from a common shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Shape
</td>
<td style="text-align:left;">
Shape parameter
</td>
<td style="text-align:left;">
Shape parameter
</td>
</tr>
<tr>
<td style="text-align:left;">
Scale
</td>
<td style="text-align:left;">
Scale parameter + treatment coefficient
</td>
<td style="text-align:left;">
Scale parameter
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the rate and shape
parameters specific to each treatment with formula:</p>
<p><code>1 /(1+((time / scale)^shape))</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg log-logistic model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="independent-shape-models-2">Independent shape models<a class="anchor" aria-label="anchor" href="#independent-shape-models-2"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Independent shape”</li>
<li>distr = “llogis”</li>
</ul>
<p>uses the flexsurv package to fit one log-logistic model with a
covariate for treatment on both the shape and scale parameters. The R
code for the fitted model is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event) ~ ARM + shape(ARM), data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "llogis")</code></p>
<p>This model outputs shape and scale parameters and a treatment
coefficient for both shape and scale. Shape and scale parameters for
each treatment are estimated in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Shape and scale parameters for intervention and reference treatments
from an independent shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Shape
</td>
<td style="text-align:left;">
Shape parameter + treatment coefficient on shape
</td>
<td style="text-align:left;">
Shape parameter
</td>
</tr>
<tr>
<td style="text-align:left;">
Scale
</td>
<td style="text-align:left;">
Scale parameter + treatment coefficient on scale
</td>
<td style="text-align:left;">
Scale parameter
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the rate and shape
parameters specific to each treatment with formula:</p>
<p><code>1 /(1+((time / scale)^shape))</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg log-logistic model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
</div>
<div class="section level2">
<h2 id="log-normal">Log-normal<a class="anchor" aria-label="anchor" href="#log-normal"></a>
</h2>
<div class="section level3">
<h3 id="separate-models-4">Separate models<a class="anchor" aria-label="anchor" href="#separate-models-4"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Separate”</li>
<li>distr = “lnorm”</li>
</ul>
<p>uses the flexsurv package to fit two log-normal models (one to data
for the intervention treatment and one to data for the reference
treatment). The R code for the fitted models is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code>
<em>data for intervention treatment </em><code>, dist = "lnorm")</code>
<code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code> <em>data
for reference treatment </em><code>, dist = "lnorm")</code></p>
<p>Estimation of the meanlog and sdlog parameters from each of these
models can be then used within the following Excel formula to estimate
survival at different time points:</p>
<p><code>1-LOGNORMDIST(time, meanlog, sdlog))</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg log-normal model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="common-shape-models-4">Common shape models<a class="anchor" aria-label="anchor" href="#common-shape-models-4"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Common shape”</li>
<li>distr = “lnorm”</li>
</ul>
<p>uses the flexsurv package to fit one log-normal model with a
covariate for treatment. The R code for the fitted model is as
follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~ARM, data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "lnorm")</code></p>
<p>This model outputs meanlog and sdlog parameters and a treatment
coefficient. Shape and scale parameters for each treatment are estimated
in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Meanlog and sdlog parameters for intervention and reference treatments
from a common shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Meanlog
</td>
<td style="text-align:left;">
Meanlog parameter + treatment coefficient
</td>
<td style="text-align:left;">
Meanlog parameter
</td>
</tr>
<tr>
<td style="text-align:left;">
Sdlog
</td>
<td style="text-align:left;">
Sdlog parameter
</td>
<td style="text-align:left;">
Sdlog parameter
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the meanlog and sdlog
parameters specific to each treatment with formula:</p>
<p><code>1-LOGNORMDIST(time, meanlog, sdlog))</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg log-normal model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="independent-shape-models-3">Independent shape models<a class="anchor" aria-label="anchor" href="#independent-shape-models-3"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Independent shape”</li>
<li>distr = “lnorm”</li>
</ul>
<p>uses the flexsurv package to fit one log-normal model with a
covariate for treatment on both the meanlog and sdlog parameters. The R
code for the fitted model is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event==1) ~ ARM + sdlog(ARM), data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "lnorm")</code></p>
<p>This model outputs meanlog and sdlog parameters and a treatment
coefficient for both meanlog and sdlog. Shape and scale parameters for
each treatment are estimated in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Meanlog and sdlog parameters for intervention and reference treatments
from an independent shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Meanlog
</td>
<td style="text-align:left;">
Meanlog parameter + treatment coefficient on meanlog
</td>
<td style="text-align:left;">
Meanlog parameter
</td>
</tr>
<tr>
<td style="text-align:left;">
Sdlog
</td>
<td style="text-align:left;">
Sdlog parameter + treatment coefficient on sdlog
</td>
<td style="text-align:left;">
Sdlog parameter
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the meanlog and sdlog
parameters specific to each treatment with formula:</p>
<p><code>1-LOGNORMDIST(time, meanlog, sdlog))</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg log-normal model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
</div>
<div class="section level2">
<h2 id="gamma">Gamma<a class="anchor" aria-label="anchor" href="#gamma"></a>
</h2>
<div class="section level3">
<h3 id="separate-models-5">Separate models<a class="anchor" aria-label="anchor" href="#separate-models-5"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Separate”</li>
<li>distr = “gamma”</li>
</ul>
<p>uses the flexsurv package to fit two gamma models (one to data for
the intervention treatment and one to data for the reference treatment).
The R code for the fitted models is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code>
<em>data for intervention treatment </em><code>, dist = "gamma")</code>
<code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code> <em>data
for reference treatment </em><code>, dist = "gamma")</code></p>
<p>Estimation of the rate and shape parameters from each of these models
can be then used within the following Excel formula to estimate survival
at different time points:</p>
<p><code>1-GAMMA.DIST(time, shape, 1/(rate),TRUE)</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg gamma model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="common-shape-models-5">Common shape models<a class="anchor" aria-label="anchor" href="#common-shape-models-5"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Common shape”</li>
<li>distr = “gamma”</li>
</ul>
<p>uses the flexsurv package to fit one gamma model with a covariate for
treatment. The R code for the fitted model is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~ARM, data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "gamma")</code></p>
<p>This model outputs rate and shape parameters and a treatment
coefficient. Rate and shape parameters for each treatment are estimated
in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Rate and shape parameters for intervention and reference treatments from
a common shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Rate
</td>
<td style="text-align:left;">
Rate parameter + treatment coefficient
</td>
<td style="text-align:left;">
Rate parameter
</td>
</tr>
<tr>
<td style="text-align:left;">
Shape
</td>
<td style="text-align:left;">
Shape parameter
</td>
<td style="text-align:left;">
Shape parameter
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the rate and shape
parameters specific to each treatment with formula:</p>
<p><code>1-GAMMA.DIST(time, shape, 1/(rate),TRUE)</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg gamma model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="independent-shape-models-4">Independent shape models<a class="anchor" aria-label="anchor" href="#independent-shape-models-4"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Independent shape”</li>
<li>distr = “gamma”</li>
</ul>
<p>uses the flexsurv package to fit one gamma model with a covariate for
treatment on both the rate and shape parameters. The R code for the
fitted model is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event) ~ ARM + shape(ARM), data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "gamma")</code></p>
<p>This model outputs rate and shape parameters and a treatment
coefficient for both rate and shape. Rate and shape parameters for each
treatment are estimated in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Rate and shape parameters for intervention and reference treatments from
an independent shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Rate
</td>
<td style="text-align:left;">
Rate parameter + treatment coefficient on rate
</td>
<td style="text-align:left;">
Rate parameter
</td>
</tr>
<tr>
<td style="text-align:left;">
Shape
</td>
<td style="text-align:left;">
Shape parameter + treatment coeffecient on shape
</td>
<td style="text-align:left;">
Shape parameter
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the rate and shape
parameters specific to each treatment with formula:</p>
<p><code>1-GAMMA.DIST(time, shape, 1/(rate),TRUE)</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg gamma model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
</div>
<div class="section level2">
<h2 id="generalized-gamma">Generalized gamma<a class="anchor" aria-label="anchor" href="#generalized-gamma"></a>
</h2>
<div class="section level3">
<h3 id="separate-models-6">Separate models<a class="anchor" aria-label="anchor" href="#separate-models-6"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Separate”</li>
<li>distr = “gengamma”</li>
</ul>
<p>uses the flexsurv package to fit two generalized gamma models (one to
data for the intervention treatment and one to data for the reference
treatment). The R code for the fitted models is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code>
<em>data for intervention treatment
</em><code>, dist = "gengamma")</code>
<code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code> <em>data
for reference treatment </em><code>, dist = "gengamma")</code></p>
<p>Estimation of the mu, sigma and Q parameters from each of these
models can be then used within the following Excel formula to estimate
survival at different time points:</p>
<p><code>IF(Q&lt;0,GAMMADIST((-Q^-2) * EXP(-Q* -((LN(time)-(mu))/sigma)),-Q^-2,1,1),1-GAMMADIST((-Q^-2) * EXP(-Q * -((LN(time)-(mu))/sigma)),-Q^-2,1,1))</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg Generalized Gamma model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="common-shape-models-6">Common shape models<a class="anchor" aria-label="anchor" href="#common-shape-models-6"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Common shape”</li>
<li>distr = “gengamma”</li>
</ul>
<p>uses the flexsurv package to fit one Generalized Gamma model with a
covariate for treatment. The R code for the fitted model is as
follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~ARM, data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "gengamma")</code></p>
<p>This model outputs mu, sigma and Q parameters and a treatment
coefficient. Mu, sigma and Q parameters for each treatment are estimated
in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Mu, sigma and Q parameters for intervention and reference treatments
from a common shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mu
</td>
<td style="text-align:left;">
mu coefficient + treatment coefficient
</td>
<td style="text-align:left;">
mu coefficient
</td>
</tr>
<tr>
<td style="text-align:left;">
Scale
</td>
<td style="text-align:left;">
sigma coefficient
</td>
<td style="text-align:left;">
sigma coefficient
</td>
</tr>
<tr>
<td style="text-align:left;">
Q
</td>
<td style="text-align:left;">
Q coefficient
</td>
<td style="text-align:left;">
Q coefficient
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the mu, sigma and Q
parameters specific to each treatment with formula:</p>
<p><code>IF(Q&lt;0,GAMMADIST((-Q^-2) * EXP(-Q* -((LN(time)-(mu))/sigma)),-Q^-2,1,1),1-GAMMADIST((-Q^-2) * EXP(-Q * -((LN(time)-(mu))/sigma)),-Q^-2,1,1))</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg Generalized Gamma model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="independent-shape-models-5">Independent shape models<a class="anchor" aria-label="anchor" href="#independent-shape-models-5"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Independent shape”</li>
<li>distr = “gengamma”</li>
</ul>
<p>uses the flexsurv package to fit one Generalized Gamma model with a
covariate for treatment on both the mu, sigma and Q parameters. The R
code for the fitted model is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event) ~ ARM + sigma(ARM) + Q(ARM), data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "gengamma")</code></p>
<p>This model outputs mu, sigma and Q parameters and a treatment
coefficient for mu, sigma and Q. Parameters for each treatment are
estimated in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Mu, sigma and Q parameters for intervention and reference treatments
from an independent shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mu
</td>
<td style="text-align:left;">
mu coefficient + treatment coefficient for mu
</td>
<td style="text-align:left;">
mu coefficient
</td>
</tr>
<tr>
<td style="text-align:left;">
Scale
</td>
<td style="text-align:left;">
sigma coefficient + treatment coefficient for sigma
</td>
<td style="text-align:left;">
sigma coefficient
</td>
</tr>
<tr>
<td style="text-align:left;">
Q
</td>
<td style="text-align:left;">
Q coefficient + treatment coefficient for Q
</td>
<td style="text-align:left;">
Q coefficient
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the mu, sigma and Q
parameters specific to each treatment with formula:</p>
<p><code>IF(Q&lt;0,GAMMADIST((-Q^-2) * EXP(-Q* -((LN(time)-(mu))/sigma)),-Q^-2,1,1),1-GAMMADIST((-Q^-2) * EXP(-Q * -((LN(time)-(mu))/sigma)),-Q^-2,1,1))</code></p>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg Generalized Gamma model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
</div>
<div class="section level2">
<h2 id="generalized-f">Generalized F<a class="anchor" aria-label="anchor" href="#generalized-f"></a>
</h2>
<div class="section level3">
<h3 id="separate-models-7">Separate models<a class="anchor" aria-label="anchor" href="#separate-models-7"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Separate”</li>
<li>distr = “genf”</li>
</ul>
<p>uses the flexsurv package to fit two generalized F models (one to
data for the intervention treatment and one to data for the reference
treatment). The R code for the fitted models is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code>
<em>data for intervention treatment </em><code>, dist = "genf")</code>
<code>flexsurvreg(formula = Surv(Time, Event)~1, data =</code> <em>data
for reference treatment </em><code>, dist = "genf")</code></p>
<p>Estimation of the mu, sigma, Q and P parameters from each of these
models can be then used within the following Excel formulas to estimate
survival at different time points:</p>
<p><code>BETA.DIST(h_m2/(h_m2 + h_m1*time^(h_d/sigma)/EXP(h_d/sigma*mu)),h_m2,h_m1,TRUE)</code></p>
<ul>
<li><code>h_m1 = 2/(Q*Q + 2*P + Q*SQRT(Q*Q + 2*P))</code></li>
<li><code>h_m2 = 2/(Q*Q + 2*P - Q*SQRT(Q*Q + 2*P))</code></li>
<li><code>h_d = SQRT(Q*Q + 2*P)</code></li>
</ul>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg Generalized F model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="common-shape-models-7">Common shape models<a class="anchor" aria-label="anchor" href="#common-shape-models-7"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Common shape”</li>
<li>distr = “genf”</li>
</ul>
<p>uses the flexsurv package to fit one Generalized F model with a
covariate for treatment. The R code for the fitted model is as
follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event)~ARM, data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "genf")</code></p>
<p>This model outputs mu, sigma Q and P parameters and a treatment
coefficient. Mu, sigma Q and P parameters for each treatment are
estimated in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Mu, sigma, Q and P parameters for intervention and reference treatments
from a common shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mu
</td>
<td style="text-align:left;">
mu coefficient + treatment coefficient
</td>
<td style="text-align:left;">
mu coefficient
</td>
</tr>
<tr>
<td style="text-align:left;">
Sigma
</td>
<td style="text-align:left;">
sigma coefficient
</td>
<td style="text-align:left;">
sigma coefficient
</td>
</tr>
<tr>
<td style="text-align:left;">
Q
</td>
<td style="text-align:left;">
Q coefficient
</td>
<td style="text-align:left;">
Q coefficient
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
P coefficient
</td>
<td style="text-align:left;">
P coefficient
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the mu, sigma, Q and P
parameters specific to each treatment with formula:</p>
<p><code>BETA.DIST(h_m2/(h_m2 + h_m1*time^(h_d/sigma)/EXP(h_d/sigma*mu)),h_m2,h_m1,TRUE)</code></p>
<ul>
<li><code>h_m1 = 2/(Q*Q + 2*P + Q*SQRT(Q*Q + 2*P))</code></li>
<li><code>h_m2 = 2/(Q*Q + 2*P - Q*SQRT(Q*Q + 2*P))</code></li>
<li><code>h_d = SQRT(Q*Q + 2*P)</code></li>
</ul>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg Generalized f model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
<div class="section level3">
<h3 id="independent-shape-models-6">Independent shape models<a class="anchor" aria-label="anchor" href="#independent-shape-models-6"></a>
</h3>
<p>The <em>run_PSM</em> function in the <em>flexsurvPlus</em> package
with the following arguments:</p>
<ul>
<li>model.type = “Independent shape”</li>
<li>distr = “genf”</li>
</ul>
<p>uses the flexsurv package to fit one Generalized F model with a
covariate for treatment on both the mu, sigma, Q and P parameters. The R
code for the fitted model is as follows:</p>
<p><code>flexsurvreg(formula = Surv(Time, Event) ~ ARM + sigma(ARM) + Q(ARM) + P(ARM), data =</code>
<em>data with a treatment variable named “ARM”
</em><code>, dist = "genf")</code></p>
<p>This model outputs mu, sigma, Q and P parameters and a treatment
coefficient for mu, sigma, Q and P. Parameters for each treatment are
estimated in <em>run_PSM</em> as follows:</p>
<table class="table">
<caption>
Mu, sigma, Q and P parameters for intervention and reference treatments
from an independent shape model
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Intervention
</th>
<th style="text-align:left;">
Reference
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mu
</td>
<td style="text-align:left;">
mu coefficient + treatment coefficient for mu
</td>
<td style="text-align:left;">
mu coefficient
</td>
</tr>
<tr>
<td style="text-align:left;">
Scale
</td>
<td style="text-align:left;">
sigma coefficient + treatment coefficient for sigma
</td>
<td style="text-align:left;">
sigma coefficient
</td>
</tr>
<tr>
<td style="text-align:left;">
Q
</td>
<td style="text-align:left;">
Q coefficient + treatment coefficient for Q
</td>
<td style="text-align:left;">
Q coefficient
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
P coefficient + treatment coefficient for P
</td>
<td style="text-align:left;">
P coefficient
</td>
</tr>
</tbody>
</table>
<p>Survival can then be estimated in Excel using the mu, sigma, Q and P
parameters specific to each treatment with formula:</p>
<p><code>BETA.DIST(h_m2/(h_m2 + h_m1*time^(h_d/sigma)/EXP(h_d/sigma*mu)),h_m2,h_m1,TRUE)</code></p>
<ul>
<li><code>h_m1 = 2/(Q*Q + 2*P + Q*SQRT(Q*Q + 2*P))</code></li>
<li><code>h_m2 = 2/(Q*Q + 2*P - Q*SQRT(Q*Q + 2*P))</code></li>
<li><code>h_d = SQRT(Q*Q + 2*P)</code></li>
</ul>
<p>This is equivalent to running the following code in R:</p>
<p><code>summary(</code> <em>flexsurvreg Generalized F model
</em><code>, type="survival", B=0, t=time)</code></p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body">
<div id="ref-latimer2011nice" class="csl-entry">
<div class="csl-left-margin">[1] </div>
<div class="csl-right-inline">Latimer N. NICE DSU technical support document
14: Survival analysis for economic evaluations alongside clinical
trials-extrapolation with patient-level data. Sheffield: Report by the
Decision Support Unit 2011;2013.</div>
</div>
<div id="ref-rutherford2020nice" class="csl-entry">
<div class="csl-left-margin">[2] </div>
<div class="csl-right-inline">Rutherford MJ, Lambert PC, Sweeting MJ,
Pennington B, Crowther MJ, Abrams KR, et al. NICE DSU TECHNICAL SUPPORT
DOCUMENT 21: Flexible methods for survival analysis 2020.</div>
</div>
<div id="ref-cadth2020" class="csl-entry">
<div class="csl-left-margin">[3] </div>
<div class="csl-right-inline">CADTH. Procedures for CADTH drug reimbursement
reviews 2020.</div>
</div>
<div id="ref-RbloggersPSM" class="csl-entry">
<div class="csl-left-margin">[4] </div>
<div class="csl-right-inline">Incerti D. Parametric survival modeling
n.d.</div>
</div>
<div id="ref-cox2008" class="csl-entry">
<div class="csl-left-margin">[5] </div>
<div class="csl-right-inline">Cox
C. The generalized f distribution: An umbrella for parametric survival
analysis. Statistics in Medicine 2008;27:4301–12.</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Iain Bennett, Jo Gregory, Sarah Smith, Richard Birnie.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
